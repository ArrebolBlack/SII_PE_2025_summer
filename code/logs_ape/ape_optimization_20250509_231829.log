2025-05-09 23:18:29,122 - INFO - APE 日志系统初始化完成
2025-05-09 23:18:29,122 - INFO - 程序启动 - DeepSeek API 密钥已加载（已隐藏）
2025-05-09 23:18:29,122 - INFO - 加载验证数据成功，样本数: 10
2025-05-09 23:18:29,122 - INFO - 限制验证数据样本数为 20 以加速评估
2025-05-09 23:18:29,152 - INFO - 
======== APE 优化迭代轮次 1/30 =========
2025-05-09 23:18:29,152 - INFO - 
===== 评估策略: initial_expert_strategy，重复次数: 10 =====
2025-05-09 23:18:29,152 - INFO - 重复评估 1/10
2025-05-09 23:18:29,334 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,334 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,334 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,345 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,345 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,345 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:29,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,694 - INFO - 重复 1/10 - 平均 NDCG@10: 0.5600
2025-05-09 23:18:37,694 - INFO - 重复评估 2/10
2025-05-09 23:18:37,957 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,958 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,959 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,959 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,960 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,960 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,961 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,961 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,962 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:37,965 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:46,824 - INFO - 重复 2/10 - 平均 NDCG@10: 0.5582
2025-05-09 23:18:46,824 - INFO - 重复评估 3/10
2025-05-09 23:18:47,011 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,011 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,013 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,013 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,013 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,014 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:47,028 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:55,904 - INFO - 重复 3/10 - 平均 NDCG@10: 0.6023
2025-05-09 23:18:55,904 - INFO - 重复评估 4/10
2025-05-09 23:18:56,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:18:56,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,338 - INFO - 重复 4/10 - 平均 NDCG@10: 0.5880
2025-05-09 23:19:04,338 - INFO - 重复评估 5/10
2025-05-09 23:19:04,523 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,524 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,527 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,527 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,546 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,546 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,546 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:04,547 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,284 - INFO - 重复 5/10 - 平均 NDCG@10: 0.5937
2025-05-09 23:19:14,284 - INFO - 重复评估 6/10
2025-05-09 23:19:14,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,556 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,558 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,558 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,559 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,559 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:14,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,472 - INFO - 重复 6/10 - 平均 NDCG@10: 0.5654
2025-05-09 23:19:22,472 - INFO - 重复评估 7/10
2025-05-09 23:19:22,644 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,645 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,646 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,669 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,670 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,671 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,672 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:22,684 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,263 - INFO - 重复 7/10 - 平均 NDCG@10: 0.5654
2025-05-09 23:19:31,263 - INFO - 重复评估 8/10
2025-05-09 23:19:31,442 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,442 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,443 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,443 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,443 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:31,452 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,678 - INFO - 重复 8/10 - 平均 NDCG@10: 0.5916
2025-05-09 23:19:40,678 - INFO - 重复评估 9/10
2025-05-09 23:19:40,931 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,932 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,933 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,934 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,934 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,935 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,936 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,937 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,947 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:40,947 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:49,955 - INFO - 重复 9/10 - 平均 NDCG@10: 0.5636
2025-05-09 23:19:49,955 - INFO - 重复评估 10/10
2025-05-09 23:19:50,310 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,310 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,311 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,311 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,311 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,312 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,312 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:50,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:19:59,807 - INFO - 重复 10/10 - 平均 NDCG@10: 0.5654
2025-05-09 23:19:59,807 - INFO - 策略 initial_expert_strategy 最终平均 NDCG@10 (共 10 次): 0.5753

2025-05-09 23:20:00,043 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,143 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "context_aware_ranking",
  "system_prompt": "你是一名专业的电影推荐系统，擅长分析用户观影序列模式。你需要通过用户的历史观影记录，识别其观影偏好和兴趣演变轨迹，并预测其下一步最可能观看的电影。请特别注意：1)用户兴趣的时序变化特征 2)电影之间的关联性 3)近期观影的强相关性",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看的在最前）：\n{history}\n\n请基于以下维度对候选电影进行专业排序：\n1. 与近期观影的相似度（类型/导演/演员）\n2. 与整体观影序列的连贯性\n3. 可能的兴趣拓展方向\n\n候选电影列表：\n{candidates}\n\n只需输出排序后的电影ID列表，不要解释。",
  "analysis": "初始策略的优点是简洁直接，但存在以下不足：1)未明确利用观影时序信息 2)缺乏对推荐维度的具体指导 3)系统角色定义过于宽泛",
  "improvement": "改进方向：1)强调时序分析能力 2)明确推荐考量维度 3)增强系统角色专业性 4)优化提示词结构以引导模型进行更细致的模式识别"
}
```
2025-05-09 23:20:18,143 - INFO - 优化提示词策略 - 新策略: {'name': 'context_aware_ranking', 'system_prompt': '你是一名专业的电影推荐系统，擅长分析用户观影序列模式。你需要通过用户的历史观影记录，识别其观影偏好和兴趣演变轨迹，并预测其下一步最可能观看的电影。请特别注意：1)用户兴趣的时序变化特征 2)电影之间的关联性 3)近期观影的强相关性', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看的在最前）：\n{history}\n\n请基于以下维度对候选电影进行专业排序：\n1. 与近期观影的相似度（类型/导演/演员）\n2. 与整体观影序列的连贯性\n3. 可能的兴趣拓展方向\n\n候选电影列表：\n{candidates}\n\n只需输出排序后的电影ID列表，不要解释。', 'analysis': '初始策略的优点是简洁直接，但存在以下不足：1)未明确利用观影时序信息 2)缺乏对推荐维度的具体指导 3)系统角色定义过于宽泛', 'improvement': '改进方向：1)强调时序分析能力 2)明确推荐考量维度 3)增强系统角色专业性 4)优化提示词结构以引导模型进行更细致的模式识别'}
2025-05-09 23:20:18,143 - INFO - 
======== APE 优化迭代轮次 2/30 =========
2025-05-09 23:20:18,143 - INFO - 
===== 评估策略: context_aware_ranking，重复次数: 10 =====
2025-05-09 23:20:18,143 - INFO - 重复评估 1/10
2025-05-09 23:20:18,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:18,370 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:23,951 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:23,951 - INFO - 重复评估 2/10
2025-05-09 23:20:24,166 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,225 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:24,228 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,152 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:30,152 - INFO - 重复评估 3/10
2025-05-09 23:20:30,511 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,512 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,512 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,513 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,541 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:30,578 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,518 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:37,519 - INFO - 重复评估 4/10
2025-05-09 23:20:37,724 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,725 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,737 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,738 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,739 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,811 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,813 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,814 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:37,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,662 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:43,662 - INFO - 重复评估 5/10
2025-05-09 23:20:43,879 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,880 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,881 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,882 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,882 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,884 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:43,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,036 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:49,036 - INFO - 重复评估 6/10
2025-05-09 23:20:49,184 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,202 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,202 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,202 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,214 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:49,270 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,127 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:54,127 - INFO - 重复评估 7/10
2025-05-09 23:20:54,412 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,413 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,414 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,414 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:54,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,165 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:20:59,165 - INFO - 重复评估 8/10
2025-05-09 23:20:59,411 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,470 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,472 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,473 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,474 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,475 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,476 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:20:59,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,595 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:04,595 - INFO - 重复评估 9/10
2025-05-09 23:21:04,778 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,828 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,829 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,829 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,829 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,830 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,830 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,830 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,830 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:04,831 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:10,878 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:10,878 - INFO - 重复评估 10/10
2025-05-09 23:21:11,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,126 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,137 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,137 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,138 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,214 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,215 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:11,215 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:15,332 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:15,332 - INFO - 策略 context_aware_ranking 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:21:15,835 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,259 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "focused_similarity_ranking",
  "system_prompt": "你是一名专业的电影推荐算法，专注于通过精确的特征匹配进行推荐。你的核心任务是：1)提取用户最近3部电影的关键特征（类型/导演/主演）2)计算候选电影与这些特征的匹配度3)优先推荐匹配特征最多的电影。请严格遵循以下规则：- 只考虑客观特征匹配- 忽略所有主观评价- 最近观看的电影权重更高- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序）：\n{history}\n\n请基于类型/导演/主演的特征匹配度，对以下候选电影进行排序：\n{candidates}\n\n只需输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. initial_expert_strategy：简单直接但缺乏特征指导，NDCG中等\n2. context_aware_ranking：过度复杂导致模型困惑，NDCG归零\n\n关键问题：\n- 迭代2引入了过多主观判断维度\n- 没有明确特征提取规则\n- 时序权重不清晰",
  "improvement": "改进建议：\n1. 限制特征比较维度（类型/导演/主演）\n2. 固定最近3部电影作为参考\n3. 明确量化匹配规则\n4. 去除所有开放性要求\n5. 标准化输出格式"
}
```
2025-05-09 23:21:36,259 - INFO - 优化提示词策略 - 新策略: {'name': 'focused_similarity_ranking', 'system_prompt': '你是一名专业的电影推荐算法，专注于通过精确的特征匹配进行推荐。你的核心任务是：1)提取用户最近3部电影的关键特征（类型/导演/主演）2)计算候选电影与这些特征的匹配度3)优先推荐匹配特征最多的电影。请严格遵循以下规则：- 只考虑客观特征匹配- 忽略所有主观评价- 最近观看的电影权重更高- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序）：\n{history}\n\n请基于类型/导演/主演的特征匹配度，对以下候选电影进行排序：\n{candidates}\n\n只需输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. initial_expert_strategy：简单直接但缺乏特征指导，NDCG中等\n2. context_aware_ranking：过度复杂导致模型困惑，NDCG归零\n\n关键问题：\n- 迭代2引入了过多主观判断维度\n- 没有明确特征提取规则\n- 时序权重不清晰', 'improvement': '改进建议：\n1. 限制特征比较维度（类型/导演/主演）\n2. 固定最近3部电影作为参考\n3. 明确量化匹配规则\n4. 去除所有开放性要求\n5. 标准化输出格式'}
2025-05-09 23:21:36,259 - INFO - 
======== APE 优化迭代轮次 3/30 =========
2025-05-09 23:21:36,259 - INFO - 
===== 评估策略: focused_similarity_ranking，重复次数: 10 =====
2025-05-09 23:21:36,259 - INFO - 重复评估 1/10
2025-05-09 23:21:36,459 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,461 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,461 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,461 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:36,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,364 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:41,364 - INFO - 重复评估 2/10
2025-05-09 23:21:41,585 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,605 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,606 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,606 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,606 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,606 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:41,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,135 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:46,135 - INFO - 重复评估 3/10
2025-05-09 23:21:46,437 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,438 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,439 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,440 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,440 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,441 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,442 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,442 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,443 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:46,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:52,780 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:52,780 - INFO - 重复评估 4/10
2025-05-09 23:21:53,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,026 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,026 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,109 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,109 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:53,113 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,729 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:21:58,729 - INFO - 重复评估 5/10
2025-05-09 23:21:58,931 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,931 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,987 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,988 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,989 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,991 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,992 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,992 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:21:58,993 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,315 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:05,315 - INFO - 重复评估 6/10
2025-05-09 23:22:05,564 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,565 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,592 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:05,672 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,608 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:10,608 - INFO - 重复评估 7/10
2025-05-09 23:22:10,894 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,894 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,911 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,911 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,911 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,911 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:10,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:11,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:15,564 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:15,565 - INFO - 重复评估 8/10
2025-05-09 23:22:16,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,013 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,014 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,015 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,015 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:16,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:21,927 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:21,927 - INFO - 重复评估 9/10
2025-05-09 23:22:22,100 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,102 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,102 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,102 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,102 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:22,143 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,192 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:27,192 - INFO - 重复评估 10/10
2025-05-09 23:22:27,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,483 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,484 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,538 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:27,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:32,425 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:22:32,425 - INFO - 策略 focused_similarity_ranking 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:22:32,791 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:57,798 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_weighted_ranking",
  "system_prompt": "你是一名专业的电影推荐系统，具备深度序列模式识别能力。你的核心任务是：1)分析用户完整观影历史的兴趣演变模式 2)识别近期(最后3部)电影的强相关特征 3)动态平衡长期偏好与短期兴趣的关系。请遵循以下规则：- 对最后3部电影给予更高权重(60%)- 考虑中期(4-10部)电影的稳定偏好(30%)- 参考早期电影的潜在兴趣(10%)- 综合评估类型/导演/演员/主题的匹配度- 允许适度的兴趣探索(15%权重)- 仅输出排序结果",
  "user_prompt_template": "用户观影历史(按时间倒序，最近观看在最前)：\n{history}\n\n请基于以下维度对候选电影进行专业排序：\n1. 与近期3部电影的特征匹配度(主要)\n2. 与中期观影的稳定偏好契合度\n3. 与整体序列的连贯性\n4. 适度的新颖性探索\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. initial_expert_strategy：基础策略但缺乏具体指导，NDCG@10为0.5753\n2. context_aware_ranking：过度复杂导致模型困惑，得分为0\n3. focused_similarity_ranking：过于局限近期3部，忽略长期兴趣，得分为0\n\n主要问题：\n- 未能平衡近期偏好与长期兴趣\n- 权重分配不明确\n- 缺乏适度的探索机制",
  "improvement": "改进建议：\n1. 引入动态权重机制：近期(60%)/中期(30%)/长期(10%)\n2. 明确特征匹配优先级：类型>导演>演员\n3. 保留15%的新颖性探索空间\n4. 简化评估维度为4个核心要素\n5. 严格规范输出格式"
}
```
2025-05-09 23:22:57,798 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_weighted_ranking', 'system_prompt': '你是一名专业的电影推荐系统，具备深度序列模式识别能力。你的核心任务是：1)分析用户完整观影历史的兴趣演变模式 2)识别近期(最后3部)电影的强相关特征 3)动态平衡长期偏好与短期兴趣的关系。请遵循以下规则：- 对最后3部电影给予更高权重(60%)- 考虑中期(4-10部)电影的稳定偏好(30%)- 参考早期电影的潜在兴趣(10%)- 综合评估类型/导演/演员/主题的匹配度- 允许适度的兴趣探索(15%权重)- 仅输出排序结果', 'user_prompt_template': '用户观影历史(按时间倒序，最近观看在最前)：\n{history}\n\n请基于以下维度对候选电影进行专业排序：\n1. 与近期3部电影的特征匹配度(主要)\n2. 与中期观影的稳定偏好契合度\n3. 与整体序列的连贯性\n4. 适度的新颖性探索\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. initial_expert_strategy：基础策略但缺乏具体指导，NDCG@10为0.5753\n2. context_aware_ranking：过度复杂导致模型困惑，得分为0\n3. focused_similarity_ranking：过于局限近期3部，忽略长期兴趣，得分为0\n\n主要问题：\n- 未能平衡近期偏好与长期兴趣\n- 权重分配不明确\n- 缺乏适度的探索机制', 'improvement': '改进建议：\n1. 引入动态权重机制：近期(60%)/中期(30%)/长期(10%)\n2. 明确特征匹配优先级：类型>导演>演员\n3. 保留15%的新颖性探索空间\n4. 简化评估维度为4个核心要素\n5. 严格规范输出格式'}
2025-05-09 23:22:57,798 - INFO - 
======== APE 优化迭代轮次 4/30 =========
2025-05-09 23:22:57,798 - INFO - 
===== 评估策略: dynamic_weighted_ranking，重复次数: 10 =====
2025-05-09 23:22:57,798 - INFO - 重复评估 1/10
2025-05-09 23:22:58,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,158 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,183 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:22:58,183 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:03,851 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:03,851 - INFO - 重复评估 2/10
2025-05-09 23:23:04,050 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,050 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,050 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,050 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,051 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,051 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,051 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,051 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,052 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:04,052 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,703 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:08,703 - INFO - 重复评估 3/10
2025-05-09 23:23:08,899 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,899 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,899 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,899 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,900 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,937 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,938 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,938 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,938 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:08,968 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:14,932 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:14,932 - INFO - 重复评估 4/10
2025-05-09 23:23:15,219 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,220 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,413 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:15,414 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,718 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:20,718 - INFO - 重复评估 5/10
2025-05-09 23:23:20,966 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,966 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,966 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,997 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,998 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,998 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,998 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,998 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,999 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:20,999 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,351 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:27,351 - INFO - 重复评估 6/10
2025-05-09 23:23:27,682 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,682 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,682 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,683 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,683 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,683 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,684 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,684 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,684 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:27,685 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,582 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:33,582 - INFO - 重复评估 7/10
2025-05-09 23:23:33,800 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,800 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,800 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:33,816 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:40,993 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:40,993 - INFO - 重复评估 8/10
2025-05-09 23:23:41,264 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,264 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,313 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,313 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,313 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,313 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,314 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,314 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,314 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:41,325 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:48,841 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:48,841 - INFO - 重复评估 9/10
2025-05-09 23:23:49,008 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,008 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,008 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:49,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,791 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:23:55,791 - INFO - 重复评估 10/10
2025-05-09 23:23:55,968 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,969 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,969 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,969 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,969 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,980 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:23:55,980 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:01,857 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:01,857 - INFO - 策略 dynamic_weighted_ranking 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:24:02,108 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,279 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "hybrid_feature_ranking",
  "system_prompt": "你是一名专业的电影推荐系统，具备多维度特征分析能力。你的核心任务是：1)提取用户观影历史中的关键特征（类型/导演/主演/主题/年代）2)计算候选电影与这些特征的匹配度，其中：- 最近1部电影权重50%- 第2-3部电影权重30%- 更早电影权重20%3)对完全匹配特征给予最高优先级4)对部分匹配特征进行加权评分5)允许10%权重给特征相似的新颖推荐。请严格遵循：- 仅基于客观特征- 最近电影有否决权（若完全不匹配）- 直接输出结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下特征维度对候选电影进行排序：\n1. 类型匹配度（最高优先级）\n2. 导演/主演延续性\n3. 相似主题/年代\n4. 适度新颖性（不超过1个）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. initial_expert_strategy：基础效果尚可但缺乏特征细化\n2. context_aware_ranking：过度复杂导致模型混淆核心目标\n3. focused_similarity_ranking：范围过窄忽略长期偏好\n4. dynamic_weighted_ranking：权重分配规则过于复杂难以执行",
  "improvement": "改进建议：\n1. 明确特征优先级（类型>导演>主演）\n2. 简化但明确的权重分配规则\n3. 保留适度新颖性但限制比例\n4. 加入否决机制确保基础相关性\n5. 使用更结构化的特征描述方式"
}
```
2025-05-09 23:24:25,279 - INFO - 优化提示词策略 - 新策略: {'name': 'hybrid_feature_ranking', 'system_prompt': '你是一名专业的电影推荐系统，具备多维度特征分析能力。你的核心任务是：1)提取用户观影历史中的关键特征（类型/导演/主演/主题/年代）2)计算候选电影与这些特征的匹配度，其中：- 最近1部电影权重50%- 第2-3部电影权重30%- 更早电影权重20%3)对完全匹配特征给予最高优先级4)对部分匹配特征进行加权评分5)允许10%权重给特征相似的新颖推荐。请严格遵循：- 仅基于客观特征- 最近电影有否决权（若完全不匹配）- 直接输出结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下特征维度对候选电影进行排序：\n1. 类型匹配度（最高优先级）\n2. 导演/主演延续性\n3. 相似主题/年代\n4. 适度新颖性（不超过1个）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. initial_expert_strategy：基础效果尚可但缺乏特征细化\n2. context_aware_ranking：过度复杂导致模型混淆核心目标\n3. focused_similarity_ranking：范围过窄忽略长期偏好\n4. dynamic_weighted_ranking：权重分配规则过于复杂难以执行', 'improvement': '改进建议：\n1. 明确特征优先级（类型>导演>主演）\n2. 简化但明确的权重分配规则\n3. 保留适度新颖性但限制比例\n4. 加入否决机制确保基础相关性\n5. 使用更结构化的特征描述方式'}
2025-05-09 23:24:25,279 - INFO - 
======== APE 优化迭代轮次 5/30 =========
2025-05-09 23:24:25,279 - INFO - 
===== 评估策略: hybrid_feature_ranking，重复次数: 10 =====
2025-05-09 23:24:25,279 - INFO - 重复评估 1/10
2025-05-09 23:24:25,552 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,558 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:25,558 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:29,889 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:29,889 - INFO - 重复评估 2/10
2025-05-09 23:24:30,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:30,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,207 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:34,207 - INFO - 重复评估 3/10
2025-05-09 23:24:34,422 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,422 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,422 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,422 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,423 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,423 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,423 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,423 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,424 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:34,432 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,425 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:39,425 - INFO - 重复评估 4/10
2025-05-09 23:24:39,623 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,623 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,623 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,624 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,624 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,624 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,624 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,625 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,629 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:39,630 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:47,823 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:47,823 - INFO - 重复评估 5/10
2025-05-09 23:24:48,019 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,039 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:48,099 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:53,899 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:24:53,899 - INFO - 重复评估 6/10
2025-05-09 23:24:54,331 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,333 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,501 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,501 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,501 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,501 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:24:54,502 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,250 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:02,250 - INFO - 重复评估 7/10
2025-05-09 23:25:02,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,509 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,509 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,509 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,510 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:02,510 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:08,998 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:08,998 - INFO - 重复评估 8/10
2025-05-09 23:25:09,191 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,191 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,191 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,192 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,192 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,192 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:09,302 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,120 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:16,120 - INFO - 重复评估 9/10
2025-05-09 23:25:16,586 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,587 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,663 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:16,663 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,682 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:21,682 - INFO - 重复评估 10/10
2025-05-09 23:25:21,880 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,880 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,881 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,881 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,881 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,881 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:21,918 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:27,971 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:27,971 - INFO - 策略 hybrid_feature_ranking 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:25:28,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,056 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "contextual_feature_fusion",
  "system_prompt": "你是一名专业的电影推荐系统，具备上下文感知的特征融合能力。你的核心任务是：1)分析用户观影历史的时序特征模式 2)识别关键特征维度（类型/导演/主演/主题/年代）的演变规律 3)动态融合近期偏好与长期兴趣。请严格遵循以下规则：- 采用三层时间衰减权重：最近1部(50%)，2-3部(30%)，4部及以上(20%)- 对完全匹配的特征给予最高优先级- 当存在多个匹配维度时，按类型>导演>主演>主题>年代的顺序评估- 允许保留一个适度新颖的推荐（不超过10%权重）- 仅输出排序结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于多维特征匹配对候选电影进行排序：\n1. 主要匹配维度：类型、导演、主演\n2. 次要匹配维度：主题、年代\n3. 时间衰减权重分配\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. initial_expert_strategy：基础策略效果尚可但缺乏特征细化\n2. context_aware_ranking：过度复杂导致模型混淆关键特征\n3. focused_similarity_ranking：范围过窄忽略长期兴趣\n4. dynamic_weighted_ranking：权重分配合理但特征维度不明确\n5. hybrid_feature_ranking：特征优先级清晰但缺乏动态调整",
  "improvement": "改进建议：\n1. 明确特征匹配的优先级顺序\n2. 采用可解释的时间衰减权重\n3. 保留适度的新颖性探索空间\n4. 简化评估维度避免信息过载\n5. 强化类型匹配的核心地位"
}
```
2025-05-09 23:25:52,056 - INFO - 优化提示词策略 - 新策略: {'name': 'contextual_feature_fusion', 'system_prompt': '你是一名专业的电影推荐系统，具备上下文感知的特征融合能力。你的核心任务是：1)分析用户观影历史的时序特征模式 2)识别关键特征维度（类型/导演/主演/主题/年代）的演变规律 3)动态融合近期偏好与长期兴趣。请严格遵循以下规则：- 采用三层时间衰减权重：最近1部(50%)，2-3部(30%)，4部及以上(20%)- 对完全匹配的特征给予最高优先级- 当存在多个匹配维度时，按类型>导演>主演>主题>年代的顺序评估- 允许保留一个适度新颖的推荐（不超过10%权重）- 仅输出排序结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于多维特征匹配对候选电影进行排序：\n1. 主要匹配维度：类型、导演、主演\n2. 次要匹配维度：主题、年代\n3. 时间衰减权重分配\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. initial_expert_strategy：基础策略效果尚可但缺乏特征细化\n2. context_aware_ranking：过度复杂导致模型混淆关键特征\n3. focused_similarity_ranking：范围过窄忽略长期兴趣\n4. dynamic_weighted_ranking：权重分配合理但特征维度不明确\n5. hybrid_feature_ranking：特征优先级清晰但缺乏动态调整', 'improvement': '改进建议：\n1. 明确特征匹配的优先级顺序\n2. 采用可解释的时间衰减权重\n3. 保留适度的新颖性探索空间\n4. 简化评估维度避免信息过载\n5. 强化类型匹配的核心地位'}
2025-05-09 23:25:52,056 - INFO - 
======== APE 优化迭代轮次 6/30 =========
2025-05-09 23:25:52,056 - INFO - 
===== 评估策略: contextual_feature_fusion，重复次数: 10 =====
2025-05-09 23:25:52,056 - INFO - 重复评估 1/10
2025-05-09 23:25:52,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:52,296 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,572 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:25:58,573 - INFO - 重复评估 2/10
2025-05-09 23:25:58,738 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,750 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,750 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,750 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,751 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,751 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,751 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,824 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,824 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:25:58,824 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,109 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:05,109 - INFO - 重复评估 3/10
2025-05-09 23:26:05,410 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,410 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,411 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,411 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,411 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,411 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,412 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,412 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,412 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:05,412 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,024 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:11,024 - INFO - 重复评估 4/10
2025-05-09 23:26:11,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,226 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,227 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,235 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:11,235 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,316 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:18,316 - INFO - 重复评估 5/10
2025-05-09 23:26:18,515 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,515 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,515 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,515 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,516 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,516 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:18,518 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,461 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:23,461 - INFO - 重复评估 6/10
2025-05-09 23:26:23,714 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,716 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,716 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,716 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,716 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:23,717 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,374 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:31,374 - INFO - 重复评估 7/10
2025-05-09 23:26:31,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,578 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,578 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,583 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,583 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,583 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:31,583 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,011 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:38,011 - INFO - 重复评估 8/10
2025-05-09 23:26:38,218 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,218 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,218 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:38,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,532 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:43,532 - INFO - 重复评估 9/10
2025-05-09 23:26:43,711 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,729 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,729 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,729 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:43,729 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:49,968 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:49,968 - INFO - 重复评估 10/10
2025-05-09 23:26:50,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,223 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:50,224 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:26:56,130 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:26:56,130 - INFO - 策略 contextual_feature_fusion 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:26:56,277 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,027 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_contextual_ranking",
  "system_prompt": "你是一名专业的电影推荐系统，具备动态上下文感知和特征融合能力。你的核心任务是：1)分析用户观影历史的时序模式和特征演变 2)识别近期偏好的关键信号 3)智能平衡特征匹配与适度探索。请严格遵循以下规则：- 采用指数时间衰减权重：最近1部(60%)，2-3部(25%)，4-6部(10%)，7部及以上(5%)- 对完全匹配的特征给予最高优先级- 当存在多个匹配维度时，按类型>导演>主演>主题>年代>评分的顺序评估- 允许保留一个适度新颖的推荐（不超过15%权重）- 当近期电影有强烈特征信号时，可适当提高该维度权重- 仅输出排序结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下维度对候选电影进行智能排序：\n1. 主要匹配维度（类型/导演/主演）的时效性权重\n2. 次要匹配维度（主题/年代）的连贯性\n3. 适度新颖性探索（最多1部）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 后续策略逐渐增加复杂度但NDCG下降，可能原因：\n   - 权重分配不够合理（如迭代4的三段式分配）\n   - 特征优先级不明确（如迭代6的多维度冲突）\n   - 时间衰减不够细致（未考虑更早历史的影响）\n3. 迭代5引入否决权可能过于严格\n4. 所有策略都缺乏对电影流行度/评分的考虑",
  "improvement": "改进建议：\n1. 采用更精细的指数时间衰减权重\n2. 明确特征维度的优先级顺序\n3. 增加评分/流行度作为后备维度\n4. 动态调整新颖性比例（根据历史多样性）\n5. 保留但弱化否决权机制\n6. 优化提示词结构，减少模型困惑"
}
```
2025-05-09 23:27:23,027 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_contextual_ranking', 'system_prompt': '你是一名专业的电影推荐系统，具备动态上下文感知和特征融合能力。你的核心任务是：1)分析用户观影历史的时序模式和特征演变 2)识别近期偏好的关键信号 3)智能平衡特征匹配与适度探索。请严格遵循以下规则：- 采用指数时间衰减权重：最近1部(60%)，2-3部(25%)，4-6部(10%)，7部及以上(5%)- 对完全匹配的特征给予最高优先级- 当存在多个匹配维度时，按类型>导演>主演>主题>年代>评分的顺序评估- 允许保留一个适度新颖的推荐（不超过15%权重）- 当近期电影有强烈特征信号时，可适当提高该维度权重- 仅输出排序结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下维度对候选电影进行智能排序：\n1. 主要匹配维度（类型/导演/主演）的时效性权重\n2. 次要匹配维度（主题/年代）的连贯性\n3. 适度新颖性探索（最多1部）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 后续策略逐渐增加复杂度但NDCG下降，可能原因：\n   - 权重分配不够合理（如迭代4的三段式分配）\n   - 特征优先级不明确（如迭代6的多维度冲突）\n   - 时间衰减不够细致（未考虑更早历史的影响）\n3. 迭代5引入否决权可能过于严格\n4. 所有策略都缺乏对电影流行度/评分的考虑', 'improvement': '改进建议：\n1. 采用更精细的指数时间衰减权重\n2. 明确特征维度的优先级顺序\n3. 增加评分/流行度作为后备维度\n4. 动态调整新颖性比例（根据历史多样性）\n5. 保留但弱化否决权机制\n6. 优化提示词结构，减少模型困惑'}
2025-05-09 23:27:23,027 - INFO - 
======== APE 优化迭代轮次 7/30 =========
2025-05-09 23:27:23,027 - INFO - 
===== 评估策略: dynamic_contextual_ranking，重复次数: 10 =====
2025-05-09 23:27:23,027 - INFO - 重复评估 1/10
2025-05-09 23:27:23,171 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,172 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,177 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,190 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:23,190 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,558 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:27:28,558 - INFO - 重复评估 2/10
2025-05-09 23:27:28,702 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,703 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,703 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,729 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,730 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:28,756 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:32,856 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:27:32,856 - INFO - 重复评估 3/10
2025-05-09 23:27:33,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:33,071 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,391 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:27:40,391 - INFO - 重复评估 4/10
2025-05-09 23:27:40,620 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,625 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,639 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,640 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,644 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,644 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,644 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,645 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:40,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,310 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:27:46,310 - INFO - 重复评估 5/10
2025-05-09 23:27:46,484 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,484 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,484 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,484 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:46,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,607 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:27:53,607 - INFO - 重复评估 6/10
2025-05-09 23:27:53,761 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,761 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,766 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,770 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,770 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,773 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,773 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:27:53,780 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,384 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:28:04,384 - INFO - 重复评估 7/10
2025-05-09 23:28:04,587 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,591 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,592 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,599 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,603 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,604 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,608 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,614 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:04,646 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:10,896 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:28:10,896 - INFO - 重复评估 8/10
2025-05-09 23:28:11,063 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,064 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,064 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,066 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,067 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,067 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,067 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:11,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,575 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:28:15,575 - INFO - 重复评估 9/10
2025-05-09 23:28:15,720 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,726 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,726 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,728 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,728 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,730 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,730 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,731 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:15,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,344 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:28:22,344 - INFO - 重复评估 10/10
2025-05-09 23:28:22,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,655 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,658 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,669 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,669 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:22,671 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:29,929 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:28:29,929 - INFO - 策略 dynamic_contextual_ranking 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:28:30,063 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,441 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "adaptive_feature_focus",
  "system_prompt": "你是一名专业的电影推荐系统，具备自适应特征聚焦能力。你的核心任务是：1)动态识别用户观影历史中最显著的特征维度（类型/导演/主演）2)根据特征显著度自动调整匹配权重 3)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 自动分析历史电影的特征分布，选择1-2个最显著的特征维度作为主要匹配标准（如80%用户近期电影都是科幻类型，则类型权重设为70%）- 次要特征维度（导演/主演）根据其出现频率动态分配权重（15-25%）- 保留5-10%权重给特征相似的新颖推荐- 当近期3部电影有强烈一致特征时，该维度获得最高优先级- 仅输出排序结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦对候选电影进行排序：\n1. 自动识别的主要特征维度：____\n2. 次要特征维度：____\n3. 适度新颖性保留位：1部\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 初始策略过于简单，缺乏特征维度细化（NDCG@10:0.5753）\n2. 后续策略虽然增加了多维度和时间衰减，但固定权重机制缺乏灵活性\n3. 所有复杂策略NDCG@10降为0，说明：\n   - 固定权重分配不符合真实用户行为模式\n   - 过多维度导致特征信号稀释\n   - 时间衰减机制可能过于机械",
  "improvement": "改进建议：\n1. 采用动态特征识别机制，自动聚焦用户最显著的特征偏好\n2. 根据特征在历史中的分布频率自动计算权重，而非固定比例\n3. 保留适度的灵活探索空间（5-10%）\n4. 简化次要维度，避免特征信号过度分散\n5. 当检测到强烈一致特征时（如连续3部同类型），自动提升该维度优先级"
}
```
2025-05-09 23:28:58,441 - INFO - 优化提示词策略 - 新策略: {'name': 'adaptive_feature_focus', 'system_prompt': '你是一名专业的电影推荐系统，具备自适应特征聚焦能力。你的核心任务是：1)动态识别用户观影历史中最显著的特征维度（类型/导演/主演）2)根据特征显著度自动调整匹配权重 3)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 自动分析历史电影的特征分布，选择1-2个最显著的特征维度作为主要匹配标准（如80%用户近期电影都是科幻类型，则类型权重设为70%）- 次要特征维度（导演/主演）根据其出现频率动态分配权重（15-25%）- 保留5-10%权重给特征相似的新颖推荐- 当近期3部电影有强烈一致特征时，该维度获得最高优先级- 仅输出排序结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦对候选电影进行排序：\n1. 自动识别的主要特征维度：____\n2. 次要特征维度：____\n3. 适度新颖性保留位：1部\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 初始策略过于简单，缺乏特征维度细化（NDCG@10:0.5753）\n2. 后续策略虽然增加了多维度和时间衰减，但固定权重机制缺乏灵活性\n3. 所有复杂策略NDCG@10降为0，说明：\n   - 固定权重分配不符合真实用户行为模式\n   - 过多维度导致特征信号稀释\n   - 时间衰减机制可能过于机械', 'improvement': '改进建议：\n1. 采用动态特征识别机制，自动聚焦用户最显著的特征偏好\n2. 根据特征在历史中的分布频率自动计算权重，而非固定比例\n3. 保留适度的灵活探索空间（5-10%）\n4. 简化次要维度，避免特征信号过度分散\n5. 当检测到强烈一致特征时（如连续3部同类型），自动提升该维度优先级'}
2025-05-09 23:28:58,441 - INFO - 
======== APE 优化迭代轮次 8/30 =========
2025-05-09 23:28:58,441 - INFO - 
===== 评估策略: adaptive_feature_focus，重复次数: 10 =====
2025-05-09 23:28:58,441 - INFO - 重复评估 1/10
2025-05-09 23:28:58,611 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,614 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,625 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,625 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,631 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,633 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:28:58,648 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:04,935 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:04,935 - INFO - 重复评估 2/10
2025-05-09 23:29:05,075 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,076 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,080 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,091 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,100 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,100 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:05,101 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:10,971 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:10,971 - INFO - 重复评估 3/10
2025-05-09 23:29:11,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,130 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,131 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,131 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:11,159 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:16,866 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:16,866 - INFO - 重复评估 4/10
2025-05-09 23:29:17,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,019 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:17,033 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,560 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:23,560 - INFO - 重复评估 5/10
2025-05-09 23:29:23,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,718 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,720 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:23,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:31,903 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:31,903 - INFO - 重复评估 6/10
2025-05-09 23:29:32,060 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,064 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,066 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,075 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,076 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:32,076 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,436 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:39,436 - INFO - 重复评估 7/10
2025-05-09 23:29:39,570 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,595 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,597 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,600 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,600 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:39,604 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,287 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:46,287 - INFO - 重复评估 8/10
2025-05-09 23:29:46,446 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:46,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,447 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:29:53,447 - INFO - 重复评估 9/10
2025-05-09 23:29:53,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,591 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,591 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,592 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,592 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,594 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,611 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,612 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,633 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:29:53,636 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,104 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:30:01,104 - INFO - 重复评估 10/10
2025-05-09 23:30:01,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,266 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,267 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:01,276 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:08,473 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:30:08,473 - INFO - 策略 adaptive_feature_focus 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:30:08,704 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,010 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention",
  "system_prompt": "你是一名专业的电影推荐系统，具备动态特征注意力机制。你的核心任务是：1)分析用户观影历史中不同类型/导演/主演的特征分布频率 2)根据特征出现频率动态分配注意力权重 3)在保持主要特征连贯性的同时智能融入次要特征。请严格遵循以下规则：- 对出现频率>50%的特征维度分配60-70%权重 - 对出现频率30-50%的特征维度分配20-30%权重 - 保留5-10%权重给特征相似的新颖推荐 - 当最近3部电影有完全一致的特征时，该特征获得最高优先级 - 仅输出排序结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征注意力机制对候选电影进行排序：\n1. 高频特征维度：____\n2. 中频特征维度：____\n3. 适度新颖性保留位：1部\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 后续策略逐渐增加复杂度但NDCG下降，可能因为：\n   - 权重分配规则过于复杂难以执行\n   - 时间衰减机制可能过度削弱长期兴趣\n   - 多维度评估标准导致注意力分散\n3. 自适应策略尝试动态调整但提示词表述不够明确",
  "improvement": "改进建议：\n1. 采用基于统计的特征注意力机制，让模型自动聚焦显著特征\n2. 简化权重分配规则，只区分高频/中频/新颖三个级别\n3. 保持最近3部电影的强相关性但不完全忽略历史\n4. 明确提示仅考虑客观特征匹配，避免主观判断"
}
```
2025-05-09 23:30:35,010 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention', 'system_prompt': '你是一名专业的电影推荐系统，具备动态特征注意力机制。你的核心任务是：1)分析用户观影历史中不同类型/导演/主演的特征分布频率 2)根据特征出现频率动态分配注意力权重 3)在保持主要特征连贯性的同时智能融入次要特征。请严格遵循以下规则：- 对出现频率>50%的特征维度分配60-70%权重 - 对出现频率30-50%的特征维度分配20-30%权重 - 保留5-10%权重给特征相似的新颖推荐 - 当最近3部电影有完全一致的特征时，该特征获得最高优先级 - 仅输出排序结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征注意力机制对候选电影进行排序：\n1. 高频特征维度：____\n2. 中频特征维度：____\n3. 适度新颖性保留位：1部\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 后续策略逐渐增加复杂度但NDCG下降，可能因为：\n   - 权重分配规则过于复杂难以执行\n   - 时间衰减机制可能过度削弱长期兴趣\n   - 多维度评估标准导致注意力分散\n3. 自适应策略尝试动态调整但提示词表述不够明确', 'improvement': '改进建议：\n1. 采用基于统计的特征注意力机制，让模型自动聚焦显著特征\n2. 简化权重分配规则，只区分高频/中频/新颖三个级别\n3. 保持最近3部电影的强相关性但不完全忽略历史\n4. 明确提示仅考虑客观特征匹配，避免主观判断'}
2025-05-09 23:30:35,010 - INFO - 
======== APE 优化迭代轮次 9/30 =========
2025-05-09 23:30:35,010 - INFO - 
===== 评估策略: dynamic_feature_attention，重复次数: 10 =====
2025-05-09 23:30:35,010 - INFO - 重复评估 1/10
2025-05-09 23:30:35,148 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,174 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:35,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,273 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:30:41,273 - INFO - 重复评估 2/10
2025-05-09 23:30:41,409 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,432 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:41,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,075 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:30:47,075 - INFO - 重复评估 3/10
2025-05-09 23:30:47,209 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,242 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,244 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,249 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:47,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:52,847 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:30:52,847 - INFO - 重复评估 4/10
2025-05-09 23:30:53,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,019 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,020 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,026 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,028 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:30:53,028 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,093 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:00,093 - INFO - 重复评估 5/10
2025-05-09 23:31:00,249 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,251 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,251 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,252 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:00,261 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,668 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:07,668 - INFO - 重复评估 6/10
2025-05-09 23:31:07,845 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,845 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,847 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,849 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,849 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,850 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,861 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,862 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:07,862 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:14,869 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:14,869 - INFO - 重复评估 7/10
2025-05-09 23:31:15,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,027 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,027 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,032 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,033 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,034 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,034 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:15,038 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,637 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:21,637 - INFO - 重复评估 8/10
2025-05-09 23:31:21,778 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,787 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,788 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,790 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,791 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,795 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,795 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,804 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:21,804 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,611 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:28,611 - INFO - 重复评估 9/10
2025-05-09 23:31:28,760 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,761 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,764 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,764 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,764 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,768 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:28,792 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:35,937 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:35,937 - INFO - 重复评估 10/10
2025-05-09 23:31:36,091 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,098 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,102 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,106 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,107 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,107 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:36,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:31:43,448 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:31:43,448 - INFO - 策略 dynamic_feature_attention 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:31:43,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,066 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "adaptive_dynamic_ensemble",
  "system_prompt": "你是一名专业的电影推荐系统，具备自适应动态集成推荐能力。你的核心任务是：1)综合分析用户观影历史中的多维特征（类型/导演/主演/主题/年代）2)采用三层动态权重分配：基础匹配(60%)+时序演进(30%)+适度探索(10%)3)实施特征交叉验证确保推荐一致性。请严格遵循以下规则：- 基础匹配层：对最近3部电影进行类型/导演/主演的精确匹配，权重60%- 时序演进层：分析4-6部电影的特征演变趋势，预测可能的兴趣变化，权重30%- 适度探索层：选择1部与基础特征相似但具有适度新颖性的电影，权重10%- 当最近2部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释",
  "user_prompt_template": "用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下策略对候选电影进行排序：\n1. 基础匹配层（最近3部电影的关键特征匹配）\n2. 时序演进层（中期电影的演变趋势分析）\n3. 适度探索层（1部特征相似的新颖推荐）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 优势：\n- 迭代1的基础策略取得了最佳实际效果(NDCG@10:0.5753)\n- 后续迭代引入了更复杂的特征分析和动态权重机制\n- 最近的迭代尝试了特征注意力机制和自适应聚焦\n\n2. 问题：\n- 过度复杂的策略导致效果下降甚至归零\n- 特征权重分配过于理论化，缺乏实证支持\n- 忽略了简单匹配策略的有效性\n- 没有处理好特征冲突时的决策规则",
  "improvement": "改进建议：\n1. 回归基础匹配策略的有效性，保留迭代1的核心优势\n2. 引入更合理的动态权重分层机制，而非复杂的数学分配\n3. 增加特征交叉验证环节确保推荐一致性\n4. 保持适度的探索性但限制其影响范围\n5. 简化决策规则，优先考虑实际有效的匹配维度"
}
```
2025-05-09 23:32:12,066 - INFO - 优化提示词策略 - 新策略: {'name': 'adaptive_dynamic_ensemble', 'system_prompt': '你是一名专业的电影推荐系统，具备自适应动态集成推荐能力。你的核心任务是：1)综合分析用户观影历史中的多维特征（类型/导演/主演/主题/年代）2)采用三层动态权重分配：基础匹配(60%)+时序演进(30%)+适度探索(10%)3)实施特征交叉验证确保推荐一致性。请严格遵循以下规则：- 基础匹配层：对最近3部电影进行类型/导演/主演的精确匹配，权重60%- 时序演进层：分析4-6部电影的特征演变趋势，预测可能的兴趣变化，权重30%- 适度探索层：选择1部与基础特征相似但具有适度新颖性的电影，权重10%- 当最近2部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释', 'user_prompt_template': '用户观影历史（按时间倒序，最近观看在最前）：\n{history}\n\n请基于以下策略对候选电影进行排序：\n1. 基础匹配层（最近3部电影的关键特征匹配）\n2. 时序演进层（中期电影的演变趋势分析）\n3. 适度探索层（1部特征相似的新颖推荐）\n\n候选电影列表：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 优势：\n- 迭代1的基础策略取得了最佳实际效果(NDCG@10:0.5753)\n- 后续迭代引入了更复杂的特征分析和动态权重机制\n- 最近的迭代尝试了特征注意力机制和自适应聚焦\n\n2. 问题：\n- 过度复杂的策略导致效果下降甚至归零\n- 特征权重分配过于理论化，缺乏实证支持\n- 忽略了简单匹配策略的有效性\n- 没有处理好特征冲突时的决策规则', 'improvement': '改进建议：\n1. 回归基础匹配策略的有效性，保留迭代1的核心优势\n2. 引入更合理的动态权重分层机制，而非复杂的数学分配\n3. 增加特征交叉验证环节确保推荐一致性\n4. 保持适度的探索性但限制其影响范围\n5. 简化决策规则，优先考虑实际有效的匹配维度'}
2025-05-09 23:32:12,066 - INFO - 
======== APE 优化迭代轮次 10/30 =========
2025-05-09 23:32:12,066 - INFO - 
===== 评估策略: adaptive_dynamic_ensemble，重复次数: 10 =====
2025-05-09 23:32:12,066 - INFO - 重复评估 1/10
2025-05-09 23:32:12,290 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,290 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,290 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:12,310 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,654 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:17,654 - INFO - 重复评估 2/10
2025-05-09 23:32:17,899 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,900 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,900 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,900 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,901 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,901 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,901 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,901 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,902 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:17,902 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,437 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:25,437 - INFO - 重复评估 3/10
2025-05-09 23:32:25,580 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:25,590 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,143 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:32,143 - INFO - 重复评估 4/10
2025-05-09 23:32:32,285 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,286 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,288 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,298 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,305 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,305 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:32,310 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,235 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:38,235 - INFO - 重复评估 5/10
2025-05-09 23:32:38,488 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:38,501 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,302 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:44,302 - INFO - 重复评估 6/10
2025-05-09 23:32:44,441 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,452 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,480 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:44,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,654 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:51,654 - INFO - 重复评估 7/10
2025-05-09 23:32:51,800 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,808 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,809 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,809 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,812 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,814 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,822 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,827 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,869 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:51,870 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,366 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:32:58,366 - INFO - 重复评估 8/10
2025-05-09 23:32:58,516 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,519 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,523 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,524 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:32:58,524 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,299 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:04,299 - INFO - 重复评估 9/10
2025-05-09 23:33:04,437 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,454 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,454 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,455 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,458 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,459 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,462 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,470 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,470 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:04,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,310 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:12,310 - INFO - 重复评估 10/10
2025-05-09 23:33:12,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,455 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,479 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:12,479 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:20,267 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:20,267 - INFO - 策略 adaptive_dynamic_ensemble 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:33:20,418 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,308 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "simplified_feature_focus",
  "system_prompt": "你是一名电影推荐专家，专注于通过关键特征匹配进行推荐。请严格遵循以下规则：1)只分析用户最近3部电影 2)优先匹配类型，其次导演，最后主演 3)完全匹配的特征优先级最高 4)直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于类型>导演>主演的优先级顺序，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示：1)过度复杂的权重分配和特征维度反而降低效果 2)initial_expert_strategy的简单直接方法表现最好 3)时间衰减和动态特征等复杂机制未能带来提升 4)保持简单直接的匹配策略可能更有效",
  "improvement": "改进建议：1)简化策略，只关注最近3部电影 2)减少特征维度，只保留类型/导演/主演 3)采用固定优先级顺序 4)去除所有复杂权重和动态调整机制 5)保持输出格式简单直接"
}
```
2025-05-09 23:33:37,308 - INFO - 优化提示词策略 - 新策略: {'name': 'simplified_feature_focus', 'system_prompt': '你是一名电影推荐专家，专注于通过关键特征匹配进行推荐。请严格遵循以下规则：1)只分析用户最近3部电影 2)优先匹配类型，其次导演，最后主演 3)完全匹配的特征优先级最高 4)直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于类型>导演>主演的优先级顺序，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示：1)过度复杂的权重分配和特征维度反而降低效果 2)initial_expert_strategy的简单直接方法表现最好 3)时间衰减和动态特征等复杂机制未能带来提升 4)保持简单直接的匹配策略可能更有效', 'improvement': '改进建议：1)简化策略，只关注最近3部电影 2)减少特征维度，只保留类型/导演/主演 3)采用固定优先级顺序 4)去除所有复杂权重和动态调整机制 5)保持输出格式简单直接'}
2025-05-09 23:33:37,308 - INFO - 
======== APE 优化迭代轮次 11/30 =========
2025-05-09 23:33:37,308 - INFO - 
===== 评估策略: simplified_feature_focus，重复次数: 10 =====
2025-05-09 23:33:37,308 - INFO - 重复评估 1/10
2025-05-09 23:33:37,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:37,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,771 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:42,771 - INFO - 重复评估 2/10
2025-05-09 23:33:42,940 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,956 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,957 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,959 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,965 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:42,975 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:43,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:43,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,435 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:49,435 - INFO - 重复评估 3/10
2025-05-09 23:33:49,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,666 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,667 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,667 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,667 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,667 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,667 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:49,677 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,394 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:33:58,395 - INFO - 重复评估 4/10
2025-05-09 23:33:58,552 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,553 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:33:58,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,117 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:03,117 - INFO - 重复评估 5/10
2025-05-09 23:34:03,252 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,266 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,266 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,281 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,963 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,963 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,972 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:03,998 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,630 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:09,630 - INFO - 重复评估 6/10
2025-05-09 23:34:09,796 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,796 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,824 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,838 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,838 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:09,840 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,197 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:14,197 - INFO - 重复评估 7/10
2025-05-09 23:34:14,332 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,337 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,343 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,344 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,349 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,351 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,351 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,351 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:14,360 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,191 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:21,191 - INFO - 重复评估 8/10
2025-05-09 23:34:21,353 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,353 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,353 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,355 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,355 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,355 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,355 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,355 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,356 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:21,375 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:27,964 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:27,964 - INFO - 重复评估 9/10
2025-05-09 23:34:28,103 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,123 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,123 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:28,123 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:33,001 - INFO - Retrying request to /chat/completions in 0.481713 seconds
2025-05-09 23:34:33,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,028 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:37,028 - INFO - 重复评估 10/10
2025-05-09 23:34:37,195 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:37,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:34:43,313 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:34:43,313 - INFO - 策略 simplified_feature_focus 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:34:43,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,696 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "weighted_feature_attention",
  "system_prompt": "你是一名专业的电影推荐系统，具备加权特征注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布 2)对类型、导演、主演三个维度分别计算出现频率 3)根据频率动态分配匹配权重（频率越高权重越大）4)对候选电影进行加权评分排序。请严格遵循以下规则：- 只考虑客观特征匹配- 最近一部电影权重50%，2-3部30%，4-5部20%- 完全匹配的特征优先级最高- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的类型/导演/主演匹配度，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. initial_expert_strategy虽然简单但效果最好，说明过度复杂的策略可能适得其反\n2. 后续策略过度强调特征分析和权重分配，可能导致模型忽略简单直接的匹配关系\n3. 时间衰减权重的设计过于复杂，实际执行效果不佳\n4. 完全忽略早期观影记录可能丢失重要信息",
  "improvement": "改进建议：\n1. 简化策略，聚焦最近5部电影的关键特征匹配\n2. 采用动态但简单的频率加权方法\n3. 保持类型>导演>主演的明确优先级\n4. 使用清晰的时间衰减权重分配（50%/30%/20%）\n5. 保持输出格式简单直接"
}
```
2025-05-09 23:35:05,696 - INFO - 优化提示词策略 - 新策略: {'name': 'weighted_feature_attention', 'system_prompt': '你是一名专业的电影推荐系统，具备加权特征注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布 2)对类型、导演、主演三个维度分别计算出现频率 3)根据频率动态分配匹配权重（频率越高权重越大）4)对候选电影进行加权评分排序。请严格遵循以下规则：- 只考虑客观特征匹配- 最近一部电影权重50%，2-3部30%，4-5部20%- 完全匹配的特征优先级最高- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的类型/导演/主演匹配度，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. initial_expert_strategy虽然简单但效果最好，说明过度复杂的策略可能适得其反\n2. 后续策略过度强调特征分析和权重分配，可能导致模型忽略简单直接的匹配关系\n3. 时间衰减权重的设计过于复杂，实际执行效果不佳\n4. 完全忽略早期观影记录可能丢失重要信息', 'improvement': '改进建议：\n1. 简化策略，聚焦最近5部电影的关键特征匹配\n2. 采用动态但简单的频率加权方法\n3. 保持类型>导演>主演的明确优先级\n4. 使用清晰的时间衰减权重分配（50%/30%/20%）\n5. 保持输出格式简单直接'}
2025-05-09 23:35:05,696 - INFO - 
======== APE 优化迭代轮次 12/30 =========
2025-05-09 23:35:05,696 - INFO - 
===== 评估策略: weighted_feature_attention，重复次数: 10 =====
2025-05-09 23:35:05,696 - INFO - 重复评估 1/10
2025-05-09 23:35:05,870 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,870 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,870 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,870 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,871 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,871 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,872 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,872 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,879 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:05,893 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:12,933 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:12,933 - INFO - 重复评估 2/10
2025-05-09 23:35:13,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,110 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,111 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,128 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:13,128 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,515 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:18,515 - INFO - 重复评估 3/10
2025-05-09 23:35:18,671 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,671 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,671 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,678 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,678 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,678 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,679 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,701 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,702 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:18,702 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:23,828 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:23,828 - INFO - 重复评估 4/10
2025-05-09 23:35:24,038 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,039 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,039 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:24,041 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,616 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:30,616 - INFO - 重复评估 5/10
2025-05-09 23:35:30,825 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,826 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,826 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,826 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,830 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,831 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,831 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,839 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,840 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:30,840 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,490 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:35,490 - INFO - 重复评估 6/10
2025-05-09 23:35:35,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,725 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,735 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,735 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:35,779 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,151 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:42,151 - INFO - 重复评估 7/10
2025-05-09 23:35:42,648 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,648 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,648 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,648 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,649 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,649 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,649 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,649 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:42,670 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,196 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:48,196 - INFO - 重复评估 8/10
2025-05-09 23:35:48,380 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,380 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,384 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,384 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,384 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:48,384 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,296 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:35:55,296 - INFO - 重复评估 9/10
2025-05-09 23:35:55,438 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,465 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,465 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,465 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,465 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,465 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,466 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,467 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:35:55,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,565 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:36:00,565 - INFO - 重复评估 10/10
2025-05-09 23:36:00,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,726 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,803 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,868 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:00,869 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:06,526 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:36:06,526 - INFO - 策略 weighted_feature_attention 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:36:06,697 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,054 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_contextual_attention",
  "system_prompt": "你是一名专业的电影推荐系统，具备动态上下文注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布模式 2)动态识别最显著的特征维度（类型/导演/主演）3)根据特征显著度和时效性分配匹配权重 4)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 对最近1部电影分配50%权重，2-3部30%，4-5部20%- 自动识别1-2个最显著的特征维度（出现频率>40%）作为主要匹配标准- 次要特征维度根据其出现频率分配剩余权重- 保留5-10%权重给与主要特征相似的新颖推荐- 当最近2部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释",
  "user_prompt_template": "用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 中期策略过于复杂，权重分配规则难以被模型准确理解\n3. 近期策略开始聚焦关键特征，但时间衰减权重设置不够合理\n4. 最佳表现仍是最简单的initial_expert_strategy(NDCG@10:0.5753)\n5. 后续策略普遍得分为0，说明复杂规则可能干扰了模型表现",
  "improvement": "改进建议：\n1. 保持简单直接的指令结构（类似初始策略）\n2. 聚焦最近3-5部电影的关键特征（类型/导演）\n3. 采用明确但不过于复杂的时间衰减权重\n4. 允许少量（10%）的新颖性探索空间\n5. 强调完全匹配特征的优先级\n6. 使用更简洁的提示词模板"
}
```
2025-05-09 23:36:33,054 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_contextual_attention', 'system_prompt': '你是一名专业的电影推荐系统，具备动态上下文注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布模式 2)动态识别最显著的特征维度（类型/导演/主演）3)根据特征显著度和时效性分配匹配权重 4)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 对最近1部电影分配50%权重，2-3部30%，4-5部20%- 自动识别1-2个最显著的特征维度（出现频率>40%）作为主要匹配标准- 次要特征维度根据其出现频率分配剩余权重- 保留5-10%权重给与主要特征相似的新颖推荐- 当最近2部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释', 'user_prompt_template': '用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 初始策略过于简单，缺乏特征分析维度\n2. 中期策略过于复杂，权重分配规则难以被模型准确理解\n3. 近期策略开始聚焦关键特征，但时间衰减权重设置不够合理\n4. 最佳表现仍是最简单的initial_expert_strategy(NDCG@10:0.5753)\n5. 后续策略普遍得分为0，说明复杂规则可能干扰了模型表现', 'improvement': '改进建议：\n1. 保持简单直接的指令结构（类似初始策略）\n2. 聚焦最近3-5部电影的关键特征（类型/导演）\n3. 采用明确但不过于复杂的时间衰减权重\n4. 允许少量（10%）的新颖性探索空间\n5. 强调完全匹配特征的优先级\n6. 使用更简洁的提示词模板'}
2025-05-09 23:36:33,054 - INFO - 
======== APE 优化迭代轮次 13/30 =========
2025-05-09 23:36:33,054 - INFO - 
===== 评估策略: dynamic_contextual_attention，重复次数: 10 =====
2025-05-09 23:36:33,054 - INFO - 重复评估 1/10
2025-05-09 23:36:33,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:33,275 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,020 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:36:39,020 - INFO - 重复评估 2/10
2025-05-09 23:36:39,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:39,248 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,258 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:36:47,258 - INFO - 重复评估 3/10
2025-05-09 23:36:47,438 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,439 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,439 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:47,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,003 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:36:55,003 - INFO - 重复评估 4/10
2025-05-09 23:36:55,163 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,164 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,164 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,164 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,164 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,165 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,165 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,165 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:36:55,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:02,947 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:02,947 - INFO - 重复评估 5/10
2025-05-09 23:37:03,108 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,108 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,108 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:03,134 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,556 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:08,556 - INFO - 重复评估 6/10
2025-05-09 23:37:08,737 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,737 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,737 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,737 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,747 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:08,747 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,076 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:13,076 - INFO - 重复评估 7/10
2025-05-09 23:37:13,327 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,328 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,347 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,348 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,402 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:13,403 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:22,996 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:22,997 - INFO - 重复评估 8/10
2025-05-09 23:37:23,163 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,163 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,163 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,163 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,171 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,171 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,171 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,171 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,240 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:23,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:28,822 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:28,822 - INFO - 重复评估 9/10
2025-05-09 23:37:29,007 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,007 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,007 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,007 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,007 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:29,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,198 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:35,198 - INFO - 重复评估 10/10
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,380 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,381 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:35,395 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:37:42,413 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:37:42,413 - INFO - 策略 dynamic_contextual_attention 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:37:42,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:02,848 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "simplified_dynamic_focus",
  "system_prompt": "你是一名专业的电影推荐系统，专注于通过最近3部电影的关键特征进行精准推荐。请严格遵循以下规则：1)只分析用户最近3部电影 2)按优先级顺序匹配：类型(60%) > 导演(30%) > 主演(10%) 3)完全匹配的特征优先级最高 4)直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于类型(60%)>导演(30%)>主演(10%)的加权匹配，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：\n1. 初始简单策略(迭代1)表现最好(NDCG@10:0.5753)，说明简洁明确的指令更有效\n2. 后续复杂策略(迭代2-13)表现差，可能原因：\n   - 过多的特征维度和权重分配导致模型混淆\n   - 时间衰减机制过于复杂\n   - 动态权重计算超出模型能力范围\n3. 迭代11的简化策略方向正确但过于简单",
  "improvement": "改进建议：\n1. 聚焦最近3部电影，避免历史过长干扰\n2. 采用固定明确的特征优先级和权重分配\n3. 保持简单直接的输出格式\n4. 放弃动态权重和复杂的时间衰减机制\n5. 给类型分配最高权重(60%)，符合电影推荐的一般规律"
}
```
2025-05-09 23:38:02,848 - INFO - 优化提示词策略 - 新策略: {'name': 'simplified_dynamic_focus', 'system_prompt': '你是一名专业的电影推荐系统，专注于通过最近3部电影的关键特征进行精准推荐。请严格遵循以下规则：1)只分析用户最近3部电影 2)按优先级顺序匹配：类型(60%) > 导演(30%) > 主演(10%) 3)完全匹配的特征优先级最高 4)直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于类型(60%)>导演(30%)>主演(10%)的加权匹配，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：\n1. 初始简单策略(迭代1)表现最好(NDCG@10:0.5753)，说明简洁明确的指令更有效\n2. 后续复杂策略(迭代2-13)表现差，可能原因：\n   - 过多的特征维度和权重分配导致模型混淆\n   - 时间衰减机制过于复杂\n   - 动态权重计算超出模型能力范围\n3. 迭代11的简化策略方向正确但过于简单', 'improvement': '改进建议：\n1. 聚焦最近3部电影，避免历史过长干扰\n2. 采用固定明确的特征优先级和权重分配\n3. 保持简单直接的输出格式\n4. 放弃动态权重和复杂的时间衰减机制\n5. 给类型分配最高权重(60%)，符合电影推荐的一般规律'}
2025-05-09 23:38:02,848 - INFO - 
======== APE 优化迭代轮次 14/30 =========
2025-05-09 23:38:02,848 - INFO - 
===== 评估策略: simplified_dynamic_focus，重复次数: 10 =====
2025-05-09 23:38:02,848 - INFO - 重复评估 1/10
2025-05-09 23:38:03,011 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,011 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,017 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,018 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,018 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:03,032 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,055 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:09,055 - INFO - 重复评估 2/10
2025-05-09 23:38:09,229 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,229 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,229 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:09,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,507 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:16,507 - INFO - 重复评估 3/10
2025-05-09 23:38:16,679 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,679 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,679 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,679 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,680 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,680 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,680 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,680 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,680 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:16,715 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,325 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:21,325 - INFO - 重复评估 4/10
2025-05-09 23:38:21,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,490 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,491 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:21,518 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,220 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:25,220 - INFO - 重复评估 5/10
2025-05-09 23:38:25,386 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,387 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,387 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,387 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,387 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:25,420 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,460 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:29,460 - INFO - 重复评估 6/10
2025-05-09 23:38:29,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,623 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,631 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,633 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,638 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:29,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,372 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:34,372 - INFO - 重复评估 7/10
2025-05-09 23:38:34,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,556 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,556 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,556 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:34,583 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,645 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:40,645 - INFO - 重复评估 8/10
2025-05-09 23:38:40,785 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,785 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,788 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,790 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,791 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,793 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,794 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,795 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:40,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:46,999 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:46,999 - INFO - 重复评估 9/10
2025-05-09 23:38:47,140 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,140 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,144 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,148 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,148 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,149 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,150 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,178 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:47,188 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:51,891 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:51,891 - INFO - 重复评估 10/10
2025-05-09 23:38:52,035 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,035 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,036 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,036 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,036 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,040 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:52,061 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:38:57,472 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:38:57,472 - INFO - 策略 simplified_dynamic_focus 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:38:57,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,142 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v2",
  "system_prompt": "你是一名专业的电影推荐系统，具备动态特征注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布模式 2)动态识别最显著的特征维度（类型/导演/主演）3)根据特征显著度和时效性分配匹配权重 4)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 对最近1部电影分配60%权重，2-3部30%，4-5部10%- 自动识别1-2个最显著的特征维度（出现频率>50%）作为主要匹配标准- 次要特征维度根据其出现频率分配剩余权重- 保留5%权重给与主要特征相似的新颖推荐- 当最近3部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释",
  "user_prompt_template": "用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的权重分配和特征维度会导致模型表现下降。简单策略如initial_expert_strategy表现最好，说明需要平衡复杂度和实用性。最近的策略尝试了动态特征注意力，但权重分配可能不够优化。",
  "improvement": "改进建议：1)简化时间衰减权重分配，突出最近1部电影的重要性(60%) 2)提高主要特征维度的识别阈值(>50%)以减少噪声 3)降低新颖性推荐的权重(5%)以保持核心特征连贯性 4)明确最近3部电影完全一致特征时的最高优先级规则"
}
```
2025-05-09 23:39:19,142 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v2', 'system_prompt': '你是一名专业的电影推荐系统，具备动态特征注意力机制。你的核心任务是：1)分析用户最近5部电影的特征分布模式 2)动态识别最显著的特征维度（类型/导演/主演）3)根据特征显著度和时效性分配匹配权重 4)在保持核心特征连贯性的同时允许适度探索。请严格遵循以下规则：- 对最近1部电影分配60%权重，2-3部30%，4-5部10%- 自动识别1-2个最显著的特征维度（出现频率>50%）作为主要匹配标准- 次要特征维度根据其出现频率分配剩余权重- 保留5%权重给与主要特征相似的新颖推荐- 当最近3部电影有完全一致的关键特征时，该特征获得最高优先级- 仅输出排序结果不要解释', 'user_prompt_template': '用户最近观看的5部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态加权的特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的权重分配和特征维度会导致模型表现下降。简单策略如initial_expert_strategy表现最好，说明需要平衡复杂度和实用性。最近的策略尝试了动态特征注意力，但权重分配可能不够优化。', 'improvement': '改进建议：1)简化时间衰减权重分配，突出最近1部电影的重要性(60%) 2)提高主要特征维度的识别阈值(>50%)以减少噪声 3)降低新颖性推荐的权重(5%)以保持核心特征连贯性 4)明确最近3部电影完全一致特征时的最高优先级规则'}
2025-05-09 23:39:19,142 - INFO - 
======== APE 优化迭代轮次 15/30 =========
2025-05-09 23:39:19,142 - INFO - 
===== 评估策略: dynamic_feature_attention_v2，重复次数: 10 =====
2025-05-09 23:39:19,142 - INFO - 重复评估 1/10
2025-05-09 23:39:19,397 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,398 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,398 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,398 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,399 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,399 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,399 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,399 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,400 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:19,400 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,646 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:24,646 - INFO - 重复评估 2/10
2025-05-09 23:39:24,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,818 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,818 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,818 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,818 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,819 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:24,822 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,443 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:30,443 - INFO - 重复评估 3/10
2025-05-09 23:39:30,587 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,595 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,596 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,602 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:30,606 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,591 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:37,591 - INFO - 重复评估 4/10
2025-05-09 23:39:37,762 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,767 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,767 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,769 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,769 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:37,774 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,102 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:44,102 - INFO - 重复评估 5/10
2025-05-09 23:39:44,253 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,253 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,253 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,253 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,253 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,254 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,254 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,255 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,255 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:44,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,421 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:50,421 - INFO - 重复评估 6/10
2025-05-09 23:39:50,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,578 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,579 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,579 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:50,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,394 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:39:58,394 - INFO - 重复评估 7/10
2025-05-09 23:39:58,541 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,542 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,542 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,542 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,543 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,546 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,548 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,548 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:39:58,551 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,590 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:40:05,590 - INFO - 重复评估 8/10
2025-05-09 23:40:05,781 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,781 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,781 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,781 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,782 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,782 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,782 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,782 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,795 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:05,855 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,755 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:40:11,755 - INFO - 重复评估 9/10
2025-05-09 23:40:11,904 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,907 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:11,907 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,506 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:40:20,506 - INFO - 重复评估 10/10
2025-05-09 23:40:20,649 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,650 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,654 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,655 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,657 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,658 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,661 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,666 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:20,670 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:26,646 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:40:26,646 - INFO - 策略 dynamic_feature_attention_v2 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:40:26,847 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,613 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v3",
  "system_prompt": "你是一名专业的电影推荐系统，具备增强型动态特征注意力机制。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于增强型动态特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：1. 初始策略过于简单，缺乏特征权重分配（NDCG@10:0.5753）2. 后续复杂策略虽然引入了时间衰减、动态权重等机制，但效果反而下降至0，可能因为：- 提示词过于复杂导致模型理解偏差- 特征维度过多造成注意力分散- 权重分配规则过于复杂难以准确执行3. 简化策略（迭代11/14）重新聚焦核心特征，但未充分利用近期观影的强相关性",
  "improvement": "改进建议：1. 聚焦最近3部电影（平衡时效性与数据量）2. 强化最近1部电影的决策权重（70%）3. 简化特征优先级为明确的层级规则4. 引入最近电影的否决权机制5. 严格控制新颖性推荐的占比（5%）6. 使用更简洁明确的指令结构"
}
```
2025-05-09 23:40:52,613 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v3', 'system_prompt': '你是一名专业的电影推荐系统，具备增强型动态特征注意力机制。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于增强型动态特征注意力机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：1. 初始策略过于简单，缺乏特征权重分配（NDCG@10:0.5753）2. 后续复杂策略虽然引入了时间衰减、动态权重等机制，但效果反而下降至0，可能因为：- 提示词过于复杂导致模型理解偏差- 特征维度过多造成注意力分散- 权重分配规则过于复杂难以准确执行3. 简化策略（迭代11/14）重新聚焦核心特征，但未充分利用近期观影的强相关性', 'improvement': '改进建议：1. 聚焦最近3部电影（平衡时效性与数据量）2. 强化最近1部电影的决策权重（70%）3. 简化特征优先级为明确的层级规则4. 引入最近电影的否决权机制5. 严格控制新颖性推荐的占比（5%）6. 使用更简洁明确的指令结构'}
2025-05-09 23:40:52,613 - INFO - 
======== APE 优化迭代轮次 16/30 =========
2025-05-09 23:40:52,613 - INFO - 
===== 评估策略: dynamic_feature_attention_v3，重复次数: 10 =====
2025-05-09 23:40:52,613 - INFO - 重复评估 1/10
2025-05-09 23:40:52,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,761 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,761 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,765 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,769 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,770 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,772 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,776 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,776 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:52,777 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:58,943 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:40:58,943 - INFO - 重复评估 2/10
2025-05-09 23:40:59,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,105 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,106 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,112 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:40:59,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:04,905 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:04,905 - INFO - 重复评估 3/10
2025-05-09 23:41:05,059 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,062 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,063 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,063 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,064 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,065 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,066 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,076 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:05,078 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,760 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:10,760 - INFO - 重复评估 4/10
2025-05-09 23:41:10,917 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,917 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,918 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,922 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,940 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,942 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,947 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,950 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,951 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:10,951 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,606 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:15,606 - INFO - 重复评估 5/10
2025-05-09 23:41:15,750 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,751 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,751 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,758 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,766 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,767 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,773 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:15,774 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,030 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:22,030 - INFO - 重复评估 6/10
2025-05-09 23:41:22,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,172 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,172 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,172 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,176 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,179 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,187 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:22,187 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,305 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:27,305 - INFO - 重复评估 7/10
2025-05-09 23:41:27,446 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,455 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,456 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,459 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:27,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:32,842 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:32,842 - INFO - 重复评估 8/10
2025-05-09 23:41:32,989 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:32,989 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,009 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:33,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,175 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:40,175 - INFO - 重复评估 9/10
2025-05-09 23:41:40,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,359 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,359 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,385 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,385 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,385 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:40,385 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,509 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:45,509 - INFO - 重复评估 10/10
2025-05-09 23:41:45,651 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,653 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,656 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,658 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,661 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,661 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,663 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,672 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,675 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:45,678 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:41:50,835 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:41:50,835 - INFO - 策略 dynamic_feature_attention_v3 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:41:51,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,790 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v4",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示：1)过度复杂的权重分配和特征维度会降低模型效果（如迭代8-10）2)专注于最近3部电影的策略表现相对较好（迭代1,11,14）3)NDCG@10最高的是最简单的initial_expert_strategy(0.5753)4)最近的dynamic_feature_attention_v3策略权重分配(70%/30%)可能还不够极端",
  "improvement": "改进建议：1)进一步简化策略，只关注最近3部电影2)加大最近1部电影的权重(80%)3)保持严格的类型>导演>主演的优先级顺序4)完全移除新颖性探索部分（历史显示这会干扰主要匹配）5)保持简洁的输出格式"
}
```
2025-05-09 23:42:13,790 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v4', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示：1)过度复杂的权重分配和特征维度会降低模型效果（如迭代8-10）2)专注于最近3部电影的策略表现相对较好（迭代1,11,14）3)NDCG@10最高的是最简单的initial_expert_strategy(0.5753)4)最近的dynamic_feature_attention_v3策略权重分配(70%/30%)可能还不够极端', 'improvement': '改进建议：1)进一步简化策略，只关注最近3部电影2)加大最近1部电影的权重(80%)3)保持严格的类型>导演>主演的优先级顺序4)完全移除新颖性探索部分（历史显示这会干扰主要匹配）5)保持简洁的输出格式'}
2025-05-09 23:42:13,790 - INFO - 
======== APE 优化迭代轮次 17/30 =========
2025-05-09 23:42:13,790 - INFO - 
===== 评估策略: dynamic_feature_attention_v4，重复次数: 10 =====
2025-05-09 23:42:13,790 - INFO - 重复评估 1/10
2025-05-09 23:42:13,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,939 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,940 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,941 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,942 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,947 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,947 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,948 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:13,964 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,793 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:19,793 - INFO - 重复评估 2/10
2025-05-09 23:42:19,995 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,996 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,996 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,996 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,996 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,997 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,997 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,997 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,997 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:19,999 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,106 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:26,106 - INFO - 重复评估 3/10
2025-05-09 23:42:26,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,320 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,321 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,322 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:26,322 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,267 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:32,267 - INFO - 重复评估 4/10
2025-05-09 23:42:32,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,477 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:32,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,388 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:38,388 - INFO - 重复评估 5/10
2025-05-09 23:42:38,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,540 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,541 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:38,543 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,760 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:45,760 - INFO - 重复评估 6/10
2025-05-09 23:42:45,911 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,916 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,916 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:45,930 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,000 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:52,000 - INFO - 重复评估 7/10
2025-05-09 23:42:52,186 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,186 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,187 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,187 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,187 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,189 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,190 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:52,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,105 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:42:58,105 - INFO - 重复评估 8/10
2025-05-09 23:42:58,262 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,263 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,263 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,263 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,264 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,267 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,270 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,270 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:42:58,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,380 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:02,380 - INFO - 重复评估 9/10
2025-05-09 23:43:02,518 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,534 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,569 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,570 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:02,570 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,338 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:08,338 - INFO - 重复评估 10/10
2025-05-09 23:43:08,503 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,505 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:08,505 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:14,653 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:14,653 - INFO - 策略 dynamic_feature_attention_v4 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:43:14,912 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,355 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v5",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的权重分配和特征维度会导致模型混乱（如迭代8-10）。简化策略（如迭代11,14）虽然更稳定但缺乏灵活性。最近的动态特征注意力版本（迭代15-17）在平衡精确性和灵活性方面表现更好，但权重分配可能过于极端（如迭代17最近1部80%权重）。",
  "improvement": "改进建议：1)保持最近1部电影的主导性但不极端（70%权重）2)保留适度的新颖性探索空间（10%权重）3)简化特征优先级逻辑但保持严格顺序4)明确否决权规则避免完全不相关的推荐5)保持简洁的输出格式要求。"
}
```
2025-05-09 23:43:38,355 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v5', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的权重分配和特征维度会导致模型混乱（如迭代8-10）。简化策略（如迭代11,14）虽然更稳定但缺乏灵活性。最近的动态特征注意力版本（迭代15-17）在平衡精确性和灵活性方面表现更好，但权重分配可能过于极端（如迭代17最近1部80%权重）。', 'improvement': '改进建议：1)保持最近1部电影的主导性但不极端（70%权重）2)保留适度的新颖性探索空间（10%权重）3)简化特征优先级逻辑但保持严格顺序4)明确否决权规则避免完全不相关的推荐5)保持简洁的输出格式要求。'}
2025-05-09 23:43:38,355 - INFO - 
======== APE 优化迭代轮次 18/30 =========
2025-05-09 23:43:38,355 - INFO - 
===== 评估策略: dynamic_feature_attention_v5，重复次数: 10 =====
2025-05-09 23:43:38,355 - INFO - 重复评估 1/10
2025-05-09 23:43:38,491 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,497 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,499 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,502 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,509 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,512 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:38,520 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,108 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:45,108 - INFO - 重复评估 2/10
2025-05-09 23:43:45,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,259 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,263 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:45,269 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,702 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:52,702 - INFO - 重复评估 3/10
2025-05-09 23:43:52,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,861 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,861 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,861 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,885 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,886 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:52,886 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:53,108 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,236 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:43:59,236 - INFO - 重复评估 4/10
2025-05-09 23:43:59,410 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,410 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,410 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,436 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,436 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,436 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,436 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,437 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,437 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:43:59,437 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:05,912 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:05,912 - INFO - 重复评估 5/10
2025-05-09 23:44:06,088 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,118 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,119 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,126 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,127 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:06,128 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,431 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:11,431 - INFO - 重复评估 6/10
2025-05-09 23:44:11,599 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,615 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:11,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,336 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:17,336 - INFO - 重复评估 7/10
2025-05-09 23:44:17,497 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,497 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,497 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,500 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,519 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:17,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,098 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:23,098 - INFO - 重复评估 8/10
2025-05-09 23:44:23,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,260 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,264 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,264 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,266 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:23,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,347 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:29,347 - INFO - 重复评估 9/10
2025-05-09 23:44:29,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,527 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,527 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,527 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,528 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,528 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,528 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,528 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,529 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:29,529 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:33,961 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:33,961 - INFO - 重复评估 10/10
2025-05-09 23:44:34,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,232 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,232 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:34,232 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:44:39,891 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:44:39,891 - INFO - 策略 dynamic_feature_attention_v5 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:44:40,147 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,230 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v6",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，虽然动态特征注意力机制在理论上是合理的，但实际效果不佳（NDCG@10持续为0）。可能原因包括：1)权重分配过于复杂2)特征维度选择不够精准3)时间衰减权重设置不合理4)缺乏有效的否决机制。initial_expert_strategy虽然简单但效果最好，说明过度复杂的策略可能适得其反。",
  "improvement": "改进建议：1)简化特征维度为类型/导演/主演/年代/评分五个核心维度2)调整时间衰减权重为最近1部75%，2-3部25%3)强化否决机制（最近1部电影主要特征必须匹配）4)减少新颖推荐权重至5%5)明确特征优先级顺序6)保持输出格式简洁。这些调整旨在平衡策略复杂度和实际效果，同时保留核心的动态特征匹配理念。"
}
```
2025-05-09 23:45:06,230 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v6', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，虽然动态特征注意力机制在理论上是合理的，但实际效果不佳（NDCG@10持续为0）。可能原因包括：1)权重分配过于复杂2)特征维度选择不够精准3)时间衰减权重设置不合理4)缺乏有效的否决机制。initial_expert_strategy虽然简单但效果最好，说明过度复杂的策略可能适得其反。', 'improvement': '改进建议：1)简化特征维度为类型/导演/主演/年代/评分五个核心维度2)调整时间衰减权重为最近1部75%，2-3部25%3)强化否决机制（最近1部电影主要特征必须匹配）4)减少新颖推荐权重至5%5)明确特征优先级顺序6)保持输出格式简洁。这些调整旨在平衡策略复杂度和实际效果，同时保留核心的动态特征匹配理念。'}
2025-05-09 23:45:06,230 - INFO - 
======== APE 优化迭代轮次 19/30 =========
2025-05-09 23:45:06,230 - INFO - 
===== 评估策略: dynamic_feature_attention_v6，重复次数: 10 =====
2025-05-09 23:45:06,230 - INFO - 重复评估 1/10
2025-05-09 23:45:06,432 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,433 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:06,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,541 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:11,541 - INFO - 重复评估 2/10
2025-05-09 23:45:11,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,762 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,763 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,764 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,764 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:11,799 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,244 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:16,244 - INFO - 重复评估 3/10
2025-05-09 23:45:16,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,420 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,463 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:16,539 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:21,935 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:21,935 - INFO - 重复评估 4/10
2025-05-09 23:45:22,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,147 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,147 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,147 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,196 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:22,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,008 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:27,008 - INFO - 重复评估 5/10
2025-05-09 23:45:27,179 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,179 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,179 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,179 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,184 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:27,229 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,253 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:33,253 - INFO - 重复评估 6/10
2025-05-09 23:45:33,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,447 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,449 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,449 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:33,449 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,391 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:41,391 - INFO - 重复评估 7/10
2025-05-09 23:45:41,572 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,572 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,572 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,598 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:41,598 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,406 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:46,406 - INFO - 重复评估 8/10
2025-05-09 23:45:46,570 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,571 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,571 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,571 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,571 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,572 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,594 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,594 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,594 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:46,594 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,372 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:52,372 - INFO - 重复评估 9/10
2025-05-09 23:45:52,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,572 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:52,604 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:56,909 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:45:56,909 - INFO - 重复评估 10/10
2025-05-09 23:45:57,278 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:45:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:02,774 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:02,774 - INFO - 策略 dynamic_feature_attention_v6 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:46:03,013 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,498 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v7",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的特征权重分配和过多的匹配维度（如加入评分）可能导致模型混淆。而最近几版策略中，对最近一部电影赋予过高权重（80%）可能忽略了用户兴趣的短期连续性。同时，完全排除所有解释虽然简洁，但可能限制了模型对复杂特征关系的理解能力。",
  "improvement": "1) 简化特征维度，移除评分等次要特征，聚焦类型/导演/主演/年代四个核心维度 2) 调整动态权重为最近1部(80%)，2-3部(20%)，在强调近期偏好的同时保留短期连续性 3) 保持严格的特征优先级和否决权机制 4) 维持5%的新颖推荐权重，确保推荐多样性 5) 保持无解释的输出格式以确保结果一致性"
}
```
2025-05-09 23:46:27,498 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v7', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的特征权重分配和过多的匹配维度（如加入评分）可能导致模型混淆。而最近几版策略中，对最近一部电影赋予过高权重（80%）可能忽略了用户兴趣的短期连续性。同时，完全排除所有解释虽然简洁，但可能限制了模型对复杂特征关系的理解能力。', 'improvement': '1) 简化特征维度，移除评分等次要特征，聚焦类型/导演/主演/年代四个核心维度 2) 调整动态权重为最近1部(80%)，2-3部(20%)，在强调近期偏好的同时保留短期连续性 3) 保持严格的特征优先级和否决权机制 4) 维持5%的新颖推荐权重，确保推荐多样性 5) 保持无解释的输出格式以确保结果一致性'}
2025-05-09 23:46:27,498 - INFO - 
======== APE 优化迭代轮次 20/30 =========
2025-05-09 23:46:27,498 - INFO - 
===== 评估策略: dynamic_feature_attention_v7，重复次数: 10 =====
2025-05-09 23:46:27,498 - INFO - 重复评估 1/10
2025-05-09 23:46:27,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,743 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,744 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:27,745 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,364 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:33,364 - INFO - 重复评估 2/10
2025-05-09 23:46:33,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,554 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:33,577 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,058 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:40,058 - INFO - 重复评估 3/10
2025-05-09 23:46:40,255 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,256 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,257 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,258 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:40,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,398 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:45,398 - INFO - 重复评估 4/10
2025-05-09 23:46:45,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:45,709 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,105 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:52,105 - INFO - 重复评估 5/10
2025-05-09 23:46:52,271 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:52,274 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,061 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:46:57,061 - INFO - 重复评估 6/10
2025-05-09 23:46:57,280 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,281 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,281 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,281 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,282 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,282 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,282 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,282 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,308 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:46:57,315 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:02,840 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:02,840 - INFO - 重复评估 7/10
2025-05-09 23:47:03,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:03,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:08,937 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:08,937 - INFO - 重复评估 8/10
2025-05-09 23:47:09,197 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,773 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:13,773 - INFO - 重复评估 9/10
2025-05-09 23:47:13,954 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,954 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,954 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:13,970 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:14,011 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:14,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:14,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:14,012 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,750 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:19,750 - INFO - 重复评估 10/10
2025-05-09 23:47:19,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,908 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,916 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,941 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:19,942 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:26,500 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:26,500 - INFO - 策略 dynamic_feature_attention_v7 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:47:26,703 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,043 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v8",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(85%)，2-3部(15%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，虽然动态特征注意力机制在理论上是合理的，但在实际应用中NDCG@10得分始终为0，表明模型未能有效理解或执行这些复杂的策略。可能的原因包括：1)提示词过于复杂导致模型混淆 2)权重分配和优先级规则过于繁琐 3)特征匹配标准不够明确 4)时间衰减权重设置不合理",
  "improvement": "改进建议：1)简化策略，专注于最近1-3部电影的关键特征匹配 2)提高最近一部电影的权重至85%，强化其主要影响力 3)保持严格的特征优先级顺序 4)减少新颖性推荐的权重至5% 5)使用更简洁明确的提示词表达 6)确保输出格式严格标准化"
}
```
2025-05-09 23:47:51,043 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v8', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(85%)，2-3部(15%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，虽然动态特征注意力机制在理论上是合理的，但在实际应用中NDCG@10得分始终为0，表明模型未能有效理解或执行这些复杂的策略。可能的原因包括：1)提示词过于复杂导致模型混淆 2)权重分配和优先级规则过于繁琐 3)特征匹配标准不够明确 4)时间衰减权重设置不合理', 'improvement': '改进建议：1)简化策略，专注于最近1-3部电影的关键特征匹配 2)提高最近一部电影的权重至85%，强化其主要影响力 3)保持严格的特征优先级顺序 4)减少新颖性推荐的权重至5% 5)使用更简洁明确的提示词表达 6)确保输出格式严格标准化'}
2025-05-09 23:47:51,043 - INFO - 
======== APE 优化迭代轮次 21/30 =========
2025-05-09 23:47:51,043 - INFO - 
===== 评估策略: dynamic_feature_attention_v8，重复次数: 10 =====
2025-05-09 23:47:51,043 - INFO - 重复评估 1/10
2025-05-09 23:47:51,234 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,234 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,234 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,235 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,235 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,245 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:51,279 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,311 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:47:56,311 - INFO - 重复评估 2/10
2025-05-09 23:47:56,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,475 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,487 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,505 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,511 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,511 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,511 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:47:56,511 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,104 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:02,104 - INFO - 重复评估 3/10
2025-05-09 23:48:02,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,297 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,298 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,301 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,301 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,301 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,306 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:02,307 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,398 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:08,398 - INFO - 重复评估 4/10
2025-05-09 23:48:08,589 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,701 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,702 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,702 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,718 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:08,720 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,334 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:13,334 - INFO - 重复评估 5/10
2025-05-09 23:48:13,488 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,488 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,488 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,488 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,489 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,496 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,496 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,507 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:13,507 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,071 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:19,071 - INFO - 重复评估 6/10
2025-05-09 23:48:19,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,291 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,309 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:19,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,350 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:24,350 - INFO - 重复评估 7/10
2025-05-09 23:48:24,512 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,521 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,522 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,522 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,522 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,522 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:24,522 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,521 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:31,521 - INFO - 重复评估 8/10
2025-05-09 23:48:31,685 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,686 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,700 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,701 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,701 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:31,701 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,287 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:36,287 - INFO - 重复评估 9/10
2025-05-09 23:48:36,505 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,506 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,506 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,507 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,507 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,673 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,674 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,674 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,674 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:36,674 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,407 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:42,407 - INFO - 重复评估 10/10
2025-05-09 23:48:42,565 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,592 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,593 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,618 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:42,618 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:48:47,314 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:48:47,314 - INFO - 策略 dynamic_feature_attention_v8 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:48:47,517 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,421 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v9",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(90%)，2-3部(10%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，随着迭代次数的增加，策略逐渐聚焦于更近期的电影特征（最近1部电影的权重从50%提升到85%），并增加了更多的特征维度（类型、导演、主演、年代、评分）。然而，NDCG@10分数一直为0.0000，表明这些策略在实际应用中可能过于复杂或权重分配不合理。initial_expert_strategy虽然简单，但获得了0.5753的分数，说明过于复杂的特征匹配可能反而降低了推荐效果。",
  "improvement": "改进建议：1)简化特征维度，只保留最核心的类型、导演、主演三个维度；2)调整权重分配，给予最近1部电影70%权重，2-3部30%权重，避免过度依赖单部电影；3)移除否决权机制，允许部分匹配的电影进入推荐列表；4)减少新颖推荐的权重至3%，更注重核心特征的匹配。"
}
```
2025-05-09 23:49:12,422 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v9', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(90%)，2-3部(10%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，随着迭代次数的增加，策略逐渐聚焦于更近期的电影特征（最近1部电影的权重从50%提升到85%），并增加了更多的特征维度（类型、导演、主演、年代、评分）。然而，NDCG@10分数一直为0.0000，表明这些策略在实际应用中可能过于复杂或权重分配不合理。initial_expert_strategy虽然简单，但获得了0.5753的分数，说明过于复杂的特征匹配可能反而降低了推荐效果。', 'improvement': '改进建议：1)简化特征维度，只保留最核心的类型、导演、主演三个维度；2)调整权重分配，给予最近1部电影70%权重，2-3部30%权重，避免过度依赖单部电影；3)移除否决权机制，允许部分匹配的电影进入推荐列表；4)减少新颖推荐的权重至3%，更注重核心特征的匹配。'}
2025-05-09 23:49:12,422 - INFO - 
======== APE 优化迭代轮次 22/30 =========
2025-05-09 23:49:12,422 - INFO - 
===== 评估策略: dynamic_feature_attention_v9，重复次数: 10 =====
2025-05-09 23:49:12,422 - INFO - 重复评估 1/10
2025-05-09 23:49:12,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,588 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,602 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,603 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,603 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,603 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,639 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,652 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,652 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:12,652 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:16,767 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:16,767 - INFO - 重复评估 2/10
2025-05-09 23:49:17,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:17,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:25,964 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:25,964 - INFO - 重复评估 3/10
2025-05-09 23:49:26,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,204 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:26,230 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,675 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:32,675 - INFO - 重复评估 4/10
2025-05-09 23:49:32,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,861 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,876 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,893 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:32,893 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,672 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:39,672 - INFO - 重复评估 5/10
2025-05-09 23:49:39,821 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,822 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,835 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,836 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,838 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,838 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,839 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,842 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,844 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:39,846 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,661 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:46,661 - INFO - 重复评估 6/10
2025-05-09 23:49:46,806 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,806 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,809 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,809 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,810 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,812 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,814 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,850 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:46,850 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,415 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:53,415 - INFO - 重复评估 7/10
2025-05-09 23:49:53,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,557 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,568 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,571 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:53,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,027 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:49:59,027 - INFO - 重复评估 8/10
2025-05-09 23:49:59,180 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,181 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,182 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,182 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,182 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,183 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,186 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,186 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,195 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:49:59,195 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,165 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:50:06,165 - INFO - 重复评估 9/10
2025-05-09 23:50:06,352 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,366 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,371 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,372 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,373 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,376 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:06,378 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,720 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:50:11,720 - INFO - 重复评估 10/10
2025-05-09 23:50:11,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,862 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,867 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,893 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:11,893 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:18,790 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:50:18,790 - INFO - 策略 dynamic_feature_attention_v9 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:50:19,005 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,176 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v10",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(85%)，2-3部(15%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度强调最近一部电影的权重（如90%）可能导致忽略用户潜在的兴趣演变。虽然NDCG@10为0，但策略演进方向值得肯定：1)逐步聚焦核心特征（类型/导演/主演）2)引入否决权机制3)保持适度新颖性。问题可能出在：1)权重分配过于极端2)特征维度过多导致冲突3)缺乏有效的部分匹配评分机制",
  "improvement": "改进建议：1)将最近一部电影权重从90%降至85%，保留一定灵活性2)移除评分维度，减少干扰3)优化部分匹配评分规则4)加强类型匹配的优先级5)保持否决权机制但设置更合理的阈值"
}
```
2025-05-09 23:50:44,176 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v10', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(85%)，2-3部(15%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度强调最近一部电影的权重（如90%）可能导致忽略用户潜在的兴趣演变。虽然NDCG@10为0，但策略演进方向值得肯定：1)逐步聚焦核心特征（类型/导演/主演）2)引入否决权机制3)保持适度新颖性。问题可能出在：1)权重分配过于极端2)特征维度过多导致冲突3)缺乏有效的部分匹配评分机制', 'improvement': '改进建议：1)将最近一部电影权重从90%降至85%，保留一定灵活性2)移除评分维度，减少干扰3)优化部分匹配评分规则4)加强类型匹配的优先级5)保持否决权机制但设置更合理的阈值'}
2025-05-09 23:50:44,176 - INFO - 
======== APE 优化迭代轮次 23/30 =========
2025-05-09 23:50:44,176 - INFO - 
===== 评估策略: dynamic_feature_attention_v10，重复次数: 10 =====
2025-05-09 23:50:44,176 - INFO - 重复评估 1/10
2025-05-09 23:50:44,323 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,325 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,326 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,326 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,328 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,328 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,334 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,335 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:44,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:50,826 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:50:50,826 - INFO - 重复评估 2/10
2025-05-09 23:50:51,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,021 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,025 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,029 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,030 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:51,052 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,319 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:50:57,319 - INFO - 重复评估 3/10
2025-05-09 23:50:57,560 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,562 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,562 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,573 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,595 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:50:57,611 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,218 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:02,218 - INFO - 重复评估 4/10
2025-05-09 23:51:02,357 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,362 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,367 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,368 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,368 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,375 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:02,385 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,755 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:08,755 - INFO - 重复评估 5/10
2025-05-09 23:51:08,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,914 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:08,928 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,169 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:14,169 - INFO - 重复评估 6/10
2025-05-09 23:51:14,312 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,312 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,322 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,323 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,325 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,331 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,331 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,343 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,349 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:14,359 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,219 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:21,219 - INFO - 重复评估 7/10
2025-05-09 23:51:21,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,434 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,435 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,452 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:21,453 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:27,823 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:27,823 - INFO - 重复评估 8/10
2025-05-09 23:51:28,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,068 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:28,070 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:34,924 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:34,924 - INFO - 重复评估 9/10
2025-05-09 23:51:35,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,198 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,199 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,231 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:35,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,446 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:41,446 - INFO - 重复评估 10/10
2025-05-09 23:51:41,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,694 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,694 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,694 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,694 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,695 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:41,719 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:51:46,608 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:51:46,608 - INFO - 策略 dynamic_feature_attention_v10 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:51:46,922 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,279 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "adaptive_feature_fusion_v2",
  "system_prompt": "你是一名专业的电影推荐系统，具备自适应特征融合能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的权重分配和特征维度会导致模型困惑（NDCG@10=0）。虽然迭代1的简单策略获得0.5753分，但后续策略因过度设计而失效。有效的策略应：1)限制特征维度数量 2)采用合理的衰减权重 3)保持简单明确的优先级规则",
  "improvement": "改进建议：1)聚焦3个核心特征维度（类型/导演/主演）2)采用80/20的简单权重分配 3)保持严格的特征优先级 4)适度控制新颖性推荐比例（10%）5)确保提示词简洁明确"
}
```
2025-05-09 23:52:09,279 - INFO - 优化提示词策略 - 新策略: {'name': 'adaptive_feature_fusion_v2', 'system_prompt': '你是一名专业的电影推荐系统，具备自适应特征融合能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代）2)采用动态权重分配：最近1部(80%)，2-3部(20%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的权重分配和特征维度会导致模型困惑（NDCG@10=0）。虽然迭代1的简单策略获得0.5753分，但后续策略因过度设计而失效。有效的策略应：1)限制特征维度数量 2)采用合理的衰减权重 3)保持简单明确的优先级规则', 'improvement': '改进建议：1)聚焦3个核心特征维度（类型/导演/主演）2)采用80/20的简单权重分配 3)保持严格的特征优先级 4)适度控制新颖性推荐比例（10%）5)确保提示词简洁明确'}
2025-05-09 23:52:09,279 - INFO - 
======== APE 优化迭代轮次 24/30 =========
2025-05-09 23:52:09,279 - INFO - 
===== 评估策略: adaptive_feature_fusion_v2，重复次数: 10 =====
2025-05-09 23:52:09,279 - INFO - 重复评估 1/10
2025-05-09 23:52:09,449 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:09,460 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,236 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:14,236 - INFO - 重复评估 2/10
2025-05-09 23:52:14,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,450 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,451 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,452 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:14,452 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,039 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:20,039 - INFO - 重复评估 3/10
2025-05-09 23:52:20,341 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,341 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,341 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,341 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,342 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:20,343 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,546 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:26,546 - INFO - 重复评估 4/10
2025-05-09 23:52:26,692 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,709 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,710 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,710 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,710 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,711 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,727 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,728 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,728 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:26,728 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,353 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:33,353 - INFO - 重复评估 5/10
2025-05-09 23:52:33,555 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,556 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,566 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,567 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:33,574 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,139 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:40,139 - INFO - 重复评估 6/10
2025-05-09 23:52:40,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,369 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,370 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,370 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,370 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,383 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:40,384 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:45,910 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:45,910 - INFO - 重复评估 7/10
2025-05-09 23:52:46,103 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,104 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,115 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,116 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:46,161 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,507 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:51,507 - INFO - 重复评估 8/10
2025-05-09 23:52:51,731 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,731 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,731 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,731 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,732 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,732 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,732 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,733 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,733 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:51,833 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:55,857 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:52:55,857 - INFO - 重复评估 9/10
2025-05-09 23:52:56,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,016 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,023 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,030 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,031 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,031 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,031 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,031 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,032 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:52:56,035 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,594 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:53:02,595 - INFO - 重复评估 10/10
2025-05-09 23:53:02,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,801 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,802 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:02,803 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:07,627 - INFO - Retrying request to /chat/completions in 0.423649 seconds
2025-05-09 23:53:08,117 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:12,206 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:53:12,207 - INFO - 策略 adaptive_feature_fusion_v2 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:53:12,454 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,462 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v11",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的特征权重分配和多维度匹配（如加入年代、评分等）反而降低了推荐效果。最佳表现仍来自最初的简单策略（NDCG@10: 0.5753）。后续策略虽然增加了各种动态权重和特征维度，但NDCG@10均为0，表明模型可能难以处理过于复杂的规则。",
  "improvement": "改进建议：1)回归简单有效的特征匹配策略，专注于类型、导演、主演三个核心维度 2)采用适中的时间衰减权重（最近1部70%，2-3部30%）3)保持10%的新颖推荐权重 4)简化优先级规则，仅保留完全匹配>部分匹配的层级 5)移除所有可能干扰模型的特征维度（如年代、评分）"
}
```
2025-05-09 23:53:37,462 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v11', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(70%)，2-3部(30%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过10%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的特征权重分配和多维度匹配（如加入年代、评分等）反而降低了推荐效果。最佳表现仍来自最初的简单策略（NDCG@10: 0.5753）。后续策略虽然增加了各种动态权重和特征维度，但NDCG@10均为0，表明模型可能难以处理过于复杂的规则。', 'improvement': '改进建议：1)回归简单有效的特征匹配策略，专注于类型、导演、主演三个核心维度 2)采用适中的时间衰减权重（最近1部70%，2-3部30%）3)保持10%的新颖推荐权重 4)简化优先级规则，仅保留完全匹配>部分匹配的层级 5)移除所有可能干扰模型的特征维度（如年代、评分）'}
2025-05-09 23:53:37,462 - INFO - 
======== APE 优化迭代轮次 25/30 =========
2025-05-09 23:53:37,462 - INFO - 
===== 评估策略: dynamic_feature_attention_v11，重复次数: 10 =====
2025-05-09 23:53:37,462 - INFO - 重复评估 1/10
2025-05-09 23:53:37,688 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,688 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,688 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,688 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,690 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,690 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,690 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,690 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,690 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:37,708 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:42,944 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:53:42,944 - INFO - 重复评估 2/10
2025-05-09 23:53:43,128 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,128 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,129 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,129 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,129 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,129 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,130 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,130 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,130 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:43,130 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,722 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:53:49,722 - INFO - 重复评估 3/10
2025-05-09 23:53:49,895 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,896 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:49,897 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,703 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:53:56,703 - INFO - 重复评估 4/10
2025-05-09 23:53:56,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,905 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,906 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,910 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:53:56,914 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,257 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:02,257 - INFO - 重复评估 5/10
2025-05-09 23:54:02,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,409 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,420 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,420 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,422 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,476 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:02,478 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:08,876 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:08,876 - INFO - 重复评估 6/10
2025-05-09 23:54:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,200 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,201 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:09,202 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:16,833 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:16,833 - INFO - 重复评估 7/10
2025-05-09 23:54:17,028 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,029 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,029 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,042 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,042 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,043 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,060 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,060 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,060 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:17,060 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,652 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:22,652 - INFO - 重复评估 8/10
2025-05-09 23:54:22,820 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,821 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,821 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,821 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,821 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,822 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,822 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,859 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:22,860 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,200 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:30,200 - INFO - 重复评估 9/10
2025-05-09 23:54:30,468 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,468 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,468 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,468 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,469 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,485 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,486 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,486 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:30,504 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,308 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:36,308 - INFO - 重复评估 10/10
2025-05-09 23:54:36,456 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,471 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,472 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,472 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,472 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,472 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,473 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,473 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,473 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:36,520 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:54:41,726 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:54:41,726 - INFO - 策略 dynamic_feature_attention_v11 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:54:41,991 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,004 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_attention_v12",
  "system_prompt": "你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，虽然动态特征注意力机制在理论上很完善，但在实际应用中NDCG@10得分始终为0.0000，表明模型未能有效理解或执行这些复杂的策略。可能原因包括：1)策略过于复杂导致模型无法准确执行 2)权重分配和优先级规则过于严格 3)缺乏有效的特征提取和匹配方法 4)模型对'否决权'等概念理解不准确",
  "improvement": "改进建议：1)简化策略，保留核心的动态权重分配和特征优先级 2)减少否决权等可能干扰模型判断的规则 3)明确特征匹配的具体方法 4)适当降低最近一部电影的权重(从85%降到75%)以平衡近期和中期偏好 5)保持适度的新颖性探索(5%) 6)增加年代和评分作为次要匹配维度"
}
```
2025-05-09 23:55:08,004 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_attention_v12', 'system_prompt': '你是一名专业的电影推荐系统，具备精准动态特征匹配和时序模式识别能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演/年代/评分）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>完全匹配年代>完全匹配评分>部分匹配类型>部分匹配导演>部分匹配主演>部分匹配年代>部分匹配评分4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演>年代>评分的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于精准动态特征匹配机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': "历史策略分析显示，虽然动态特征注意力机制在理论上很完善，但在实际应用中NDCG@10得分始终为0.0000，表明模型未能有效理解或执行这些复杂的策略。可能原因包括：1)策略过于复杂导致模型无法准确执行 2)权重分配和优先级规则过于严格 3)缺乏有效的特征提取和匹配方法 4)模型对'否决权'等概念理解不准确", 'improvement': '改进建议：1)简化策略，保留核心的动态权重分配和特征优先级 2)减少否决权等可能干扰模型判断的规则 3)明确特征匹配的具体方法 4)适当降低最近一部电影的权重(从85%降到75%)以平衡近期和中期偏好 5)保持适度的新颖性探索(5%) 6)增加年代和评分作为次要匹配维度'}
2025-05-09 23:55:08,004 - INFO - 
======== APE 优化迭代轮次 26/30 =========
2025-05-09 23:55:08,004 - INFO - 
===== 评估策略: dynamic_feature_attention_v12，重复次数: 10 =====
2025-05-09 23:55:08,004 - INFO - 重复评估 1/10
2025-05-09 23:55:08,239 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,240 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,240 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,240 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,240 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,241 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:08,242 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:13,886 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:13,886 - INFO - 重复评估 2/10
2025-05-09 23:55:14,072 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,072 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,072 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,074 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,077 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:14,077 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,405 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:20,405 - INFO - 重复评估 3/10
2025-05-09 23:55:20,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,616 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:20,618 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:27,986 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:27,986 - INFO - 重复评估 4/10
2025-05-09 23:55:28,145 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,205 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,206 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,207 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:28,208 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:33,777 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:33,777 - INFO - 重复评估 5/10
2025-05-09 23:55:33,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:33,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:33,991 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:33,991 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:33,991 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:34,001 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:34,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:34,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:34,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:34,022 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,303 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:40,303 - INFO - 重复评估 6/10
2025-05-09 23:55:40,548 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,548 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,582 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:40,615 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,228 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:46,228 - INFO - 重复评估 7/10
2025-05-09 23:55:46,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,418 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,418 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,418 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,418 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:46,419 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,448 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:52,448 - INFO - 重复评估 8/10
2025-05-09 23:55:52,612 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,613 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,621 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,622 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:52,642 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,735 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:55:58,735 - INFO - 重复评估 9/10
2025-05-09 23:55:58,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,913 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,914 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,914 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,914 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,915 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,915 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,921 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,932 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:55:58,948 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,453 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:56:05,453 - INFO - 重复评估 10/10
2025-05-09 23:56:05,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,746 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,747 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,753 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,753 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,753 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,753 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:05,754 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:11,307 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:56:11,307 - INFO - 策略 dynamic_feature_attention_v12 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:56:11,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,754 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "adaptive_feature_focus_v3",
  "system_prompt": "你是一名专业的电影推荐系统，具备自适应特征聚焦和动态权重调整能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)根据特征一致性动态调整权重分配：当最近3部电影有2部以上共享同一特征时，该特征权重提升至80%3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示：1)过度复杂的权重分配机制（如多层时间衰减）导致模型困惑，NDCG降至0；2)引入过多特征维度（年代/评分）分散了核心特征注意力；3)最佳表现仍来自初始简单策略（NDCG@10:0.5753），说明清晰明确的特征优先级是关键；4)后续策略虽然精细化但缺乏灵活性，无法适应不同用户的特征分布特点",
  "improvement": "改进建议：1)回归简单有效的3部电影分析框架；2)引入动态特征权重调整机制，当检测到强烈特征信号时自动提升该维度权重；3)保持严格的特征优先级顺序；4)控制新颖性推荐比例不超过5%；5)简化提示词结构，避免复杂的时间衰减规则"
}
```
2025-05-09 23:56:38,754 - INFO - 优化提示词策略 - 新策略: {'name': 'adaptive_feature_focus_v3', 'system_prompt': '你是一名专业的电影推荐系统，具备自适应特征聚焦和动态权重调整能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)根据特征一致性动态调整权重分配：当最近3部电影有2部以上共享同一特征时，该特征权重提升至80%3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示：1)过度复杂的权重分配机制（如多层时间衰减）导致模型困惑，NDCG降至0；2)引入过多特征维度（年代/评分）分散了核心特征注意力；3)最佳表现仍来自初始简单策略（NDCG@10:0.5753），说明清晰明确的特征优先级是关键；4)后续策略虽然精细化但缺乏灵活性，无法适应不同用户的特征分布特点', 'improvement': '改进建议：1)回归简单有效的3部电影分析框架；2)引入动态特征权重调整机制，当检测到强烈特征信号时自动提升该维度权重；3)保持严格的特征优先级顺序；4)控制新颖性推荐比例不超过5%；5)简化提示词结构，避免复杂的时间衰减规则'}
2025-05-09 23:56:38,754 - INFO - 
======== APE 优化迭代轮次 27/30 =========
2025-05-09 23:56:38,754 - INFO - 
===== 评估策略: adaptive_feature_focus_v3，重复次数: 10 =====
2025-05-09 23:56:38,754 - INFO - 重复评估 1/10
2025-05-09 23:56:38,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,919 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,920 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,920 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,921 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,971 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,971 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:38,971 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,001 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:56:44,001 - INFO - 重复评估 2/10
2025-05-09 23:56:44,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,444 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,445 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,445 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,445 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,445 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,446 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,508 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:44,585 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,647 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:56:52,647 - INFO - 重复评估 3/10
2025-05-09 23:56:52,889 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,890 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,890 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,932 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,933 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,933 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,933 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,936 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,936 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:52,936 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,510 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:56:58,510 - INFO - 重复评估 4/10
2025-05-09 23:56:58,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,712 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,713 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:56:58,714 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,487 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:05,487 - INFO - 重复评估 5/10
2025-05-09 23:57:05,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,668 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,676 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,676 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,676 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,676 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,676 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:05,706 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,378 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:11,378 - INFO - 重复评估 6/10
2025-05-09 23:57:11,575 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,609 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,610 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,636 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,637 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:11,663 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:18,735 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:18,735 - INFO - 重复评估 7/10
2025-05-09 23:57:19,072 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,073 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,074 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,074 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,074 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,074 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,075 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:19,075 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,100 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:26,100 - INFO - 重复评估 8/10
2025-05-09 23:57:26,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,295 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:26,296 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:31,108 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:31,108 - INFO - 重复评估 9/10
2025-05-09 23:57:31,643 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:31,643 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:31,643 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:31,643 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:31,644 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:32,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:32,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:32,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:32,146 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:32,147 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,297 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:40,297 - INFO - 重复评估 10/10
2025-05-09 23:57:40,492 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,493 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,562 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,563 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,563 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,563 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,563 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,564 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:40,564 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:57:46,236 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:57:46,236 - INFO - 策略 adaptive_feature_focus_v3 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:57:46,707 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:13,914 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_focus_v4",
  "system_prompt": "你是一名专业的电影推荐系统，具备动态特征聚焦和智能权重分配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)根据特征一致性和时效性动态分配权重：最近1部电影(70%)，2-3部(30%)；当最近2部及以上电影共享同一特征时，该特征权重提升20% 3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演 4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析：1. 初始策略过于简单，缺乏特征权重分配机制 2. 后续策略逐渐复杂化，但部分策略权重分配过于复杂导致效果下降 3. 最佳表现仍为初始简单策略(NDCG@10:0.5753) 4. 过度强调近期电影可能导致忽略用户稳定偏好 5. 部分策略尝试引入过多特征维度反而降低了核心特征的匹配精度",
  "improvement": "改进建议：1. 保持简单有效的核心特征匹配机制 2. 采用动态但不过于复杂的权重分配 3. 强化近期电影的关键特征匹配 4. 适度保留新颖性推荐但不影响核心推荐质量 5. 明确特征优先级顺序避免匹配混乱 6. 保持输出格式简洁一致"
}
```
2025-05-09 23:58:13,914 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_focus_v4', 'system_prompt': '你是一名专业的电影推荐系统，具备动态特征聚焦和智能权重分配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)根据特征一致性和时效性动态分配权重：最近1部电影(70%)，2-3部(30%)；当最近2部及以上电影共享同一特征时，该特征权重提升20% 3)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演 4)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析：1. 初始策略过于简单，缺乏特征权重分配机制 2. 后续策略逐渐复杂化，但部分策略权重分配过于复杂导致效果下降 3. 最佳表现仍为初始简单策略(NDCG@10:0.5753) 4. 过度强调近期电影可能导致忽略用户稳定偏好 5. 部分策略尝试引入过多特征维度反而降低了核心特征的匹配精度', 'improvement': '改进建议：1. 保持简单有效的核心特征匹配机制 2. 采用动态但不过于复杂的权重分配 3. 强化近期电影的关键特征匹配 4. 适度保留新颖性推荐但不影响核心推荐质量 5. 明确特征优先级顺序避免匹配混乱 6. 保持输出格式简洁一致'}
2025-05-09 23:58:13,914 - INFO - 
======== APE 优化迭代轮次 28/30 =========
2025-05-09 23:58:13,914 - INFO - 
===== 评估策略: dynamic_feature_focus_v4，重复次数: 10 =====
2025-05-09 23:58:13,914 - INFO - 重复评估 1/10
2025-05-09 23:58:14,078 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,091 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,092 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,093 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,132 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,133 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:14,159 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,239 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:19,239 - INFO - 重复评估 2/10
2025-05-09 23:58:19,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,416 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:19,417 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:26,898 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:26,898 - INFO - 重复评估 3/10
2025-05-09 23:58:28,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,315 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,315 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,315 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,315 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,316 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,316 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,316 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,316 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:28,317 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,320 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:33,320 - INFO - 重复评估 4/10
2025-05-09 23:58:33,524 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,532 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,533 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:33,538 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,624 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:39,624 - INFO - 重复评估 5/10
2025-05-09 23:58:39,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,815 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,816 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,816 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,816 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,816 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:39,817 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,028 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:44,028 - INFO - 重复评估 6/10
2025-05-09 23:58:44,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,248 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,248 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:44,319 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,342 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:50,342 - INFO - 重复评估 7/10
2025-05-09 23:58:50,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,530 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,531 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:50,551 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:54,886 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:58:54,886 - INFO - 重复评估 8/10
2025-05-09 23:58:55,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,120 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,121 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:58:55,122 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,112 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:02,112 - INFO - 重复评估 9/10
2025-05-09 23:59:02,333 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,345 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,346 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,356 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,371 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,372 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,372 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:02,372 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:06,807 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:06,807 - INFO - 重复评估 10/10
2025-05-09 23:59:06,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:06,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:06,990 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,002 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,003 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:07,024 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:12,596 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:12,596 - INFO - 策略 dynamic_feature_focus_v4 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-09 23:59:12,849 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,513 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_focus_v5",
  "system_prompt": "你是一名专业的电影推荐系统，具备增强型动态特征聚焦能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)当最近2部及以上电影共享同一特征时，该特征权重提升30%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于增强型动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示：1)过度复杂的特征权重分配(如迭代10的三层动态权重)导致效果下降 2)最佳表现来自简单的最近3部电影聚焦(迭代1的0.5753) 3)后期策略虽然增加了特征维度(年代/评分)但未带来提升 4)动态权重调整策略(如迭代28)未能有效提升效果",
  "improvement": "改进建议：1)回归简单有效的最近3部电影聚焦策略 2)增强特征一致性的奖励机制(当2+部电影共享特征时显著提升权重) 3)保持严格的类型>导演>主演优先级 4)控制新颖性推荐在5%以下 5)简化提示词结构，减少模型困惑"
}
```
2025-05-09 23:59:36,513 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_focus_v5', 'system_prompt': '你是一名专业的电影推荐系统，具备增强型动态特征聚焦能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用动态权重分配：最近1部(75%)，2-3部(25%)3)当最近2部及以上电影共享同一特征时，该特征权重提升30%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于增强型动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示：1)过度复杂的特征权重分配(如迭代10的三层动态权重)导致效果下降 2)最佳表现来自简单的最近3部电影聚焦(迭代1的0.5753) 3)后期策略虽然增加了特征维度(年代/评分)但未带来提升 4)动态权重调整策略(如迭代28)未能有效提升效果', 'improvement': '改进建议：1)回归简单有效的最近3部电影聚焦策略 2)增强特征一致性的奖励机制(当2+部电影共享特征时显著提升权重) 3)保持严格的类型>导演>主演优先级 4)控制新颖性推荐在5%以下 5)简化提示词结构，减少模型困惑'}
2025-05-09 23:59:36,513 - INFO - 
======== APE 优化迭代轮次 29/30 =========
2025-05-09 23:59:36,513 - INFO - 
===== 评估策略: dynamic_feature_focus_v5，重复次数: 10 =====
2025-05-09 23:59:36,513 - INFO - 重复评估 1/10
2025-05-09 23:59:36,771 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,858 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,858 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,909 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:36,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:37,055 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,034 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:42,034 - INFO - 重复评估 2/10
2025-05-09 23:59:42,271 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,272 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,273 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,292 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:42,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,419 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:49,419 - INFO - 重复评估 3/10
2025-05-09 23:59:49,607 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,608 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,608 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,608 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,608 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,609 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,609 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,609 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:49,617 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,150 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-09 23:59:55,150 - INFO - 重复评估 4/10
2025-05-09 23:59:55,670 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,670 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,692 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,692 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,692 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,693 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-09 23:59:55,694 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,510 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:02,510 - INFO - 重复评估 5/10
2025-05-10 00:00:02,738 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,739 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,739 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,739 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,739 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,759 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,760 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,760 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,760 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:02,774 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:06,867 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:06,867 - INFO - 重复评估 6/10
2025-05-10 00:00:07,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,069 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,123 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,124 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,124 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,125 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,125 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,125 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:07,125 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,600 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:13,600 - INFO - 重复评估 7/10
2025-05-10 00:00:13,923 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,923 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,923 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,924 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,925 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:13,925 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:20,987 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:20,987 - INFO - 重复评估 8/10
2025-05-10 00:00:21,217 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,293 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:21,294 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,710 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:25,710 - INFO - 重复评估 9/10
2025-05-10 00:00:25,907 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,907 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,928 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,929 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,929 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,929 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,929 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:25,930 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:26,065 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:26,065 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:31,972 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:31,972 - INFO - 重复评估 10/10
2025-05-10 00:00:32,245 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,245 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,245 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,246 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:32,247 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:00:38,144 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:00:38,144 - INFO - 策略 dynamic_feature_focus_v5 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-10 00:00:38,519 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,309 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "dynamic_feature_focus_v6",
  "system_prompt": "你是一名专业的电影推荐系统，具备智能动态特征聚焦能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用智能权重分配：最近1部(80%)，2-3部(20%)3)当最近2部及以上电影共享同一特征时，该特征权重提升40%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于智能动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，虽然动态特征聚焦和权重调整机制在理论上是合理的，但实际效果不佳（NDCG@10均为0）。可能原因包括：1)过于复杂的权重分配规则可能干扰模型判断 2)特征匹配优先级过于刚性 3)否决权机制可能过度限制了推荐多样性",
  "improvement": "改进建议：1)简化权重分配规则，增强最近一部电影的影响力(80%) 2)提升特征一致性的权重提升幅度(40%)以强化主要信号 3)保持但适度放宽否决权机制 4)保留最小程度的新颖性探索(5%)"
}
```
2025-05-10 00:01:02,309 - INFO - 优化提示词策略 - 新策略: {'name': 'dynamic_feature_focus_v6', 'system_prompt': '你是一名专业的电影推荐系统，具备智能动态特征聚焦能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用智能权重分配：最近1部(80%)，2-3部(20%)3)当最近2部及以上电影共享同一特征时，该特征权重提升40%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于智能动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，虽然动态特征聚焦和权重调整机制在理论上是合理的，但实际效果不佳（NDCG@10均为0）。可能原因包括：1)过于复杂的权重分配规则可能干扰模型判断 2)特征匹配优先级过于刚性 3)否决权机制可能过度限制了推荐多样性', 'improvement': '改进建议：1)简化权重分配规则，增强最近一部电影的影响力(80%) 2)提升特征一致性的权重提升幅度(40%)以强化主要信号 3)保持但适度放宽否决权机制 4)保留最小程度的新颖性探索(5%)'}
2025-05-10 00:01:02,309 - INFO - 
======== APE 优化迭代轮次 30/30 =========
2025-05-10 00:01:02,309 - INFO - 
===== 评估策略: dynamic_feature_focus_v6，重复次数: 10 =====
2025-05-10 00:01:02,309 - INFO - 重复评估 1/10
2025-05-10 00:01:02,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,549 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,550 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,551 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,551 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,551 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:02,576 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:07,816 - INFO - 重复 1/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:07,816 - INFO - 重复评估 2/10
2025-05-10 00:01:08,152 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,152 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,169 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,170 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,170 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:08,192 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,164 - INFO - 重复 2/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:17,164 - INFO - 重复评估 3/10
2025-05-10 00:01:17,467 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,525 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:17,526 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,343 - INFO - 重复 3/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:24,343 - INFO - 重复评估 4/10
2025-05-10 00:01:24,543 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,544 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,544 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,544 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,545 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,561 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:24,561 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,175 - INFO - 重复 4/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:31,175 - INFO - 重复评估 5/10
2025-05-10 00:01:31,395 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,415 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,431 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,431 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,431 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,431 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,431 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,432 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:31,448 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,644 - INFO - 重复 5/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:39,644 - INFO - 重复评估 6/10
2025-05-10 00:01:39,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,865 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,866 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,867 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,867 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:39,930 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,184 - INFO - 重复 6/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:45,184 - INFO - 重复评估 7/10
2025-05-10 00:01:45,399 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,400 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,400 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,400 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,401 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:45,402 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,126 - INFO - 重复 7/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:52,126 - INFO - 重复评估 8/10
2025-05-10 00:01:52,392 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,392 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,392 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,392 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,392 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,393 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:52,394 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:57,825 - INFO - 重复 8/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:01:57,825 - INFO - 重复评估 9/10
2025-05-10 00:01:58,134 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,135 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,135 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,135 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,135 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,136 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,136 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,136 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,136 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:01:58,137 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,112 - INFO - 重复 9/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:02:05,112 - INFO - 重复评估 10/10
2025-05-10 00:02:05,357 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,357 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,357 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,357 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,358 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,365 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,365 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,365 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,365 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:05,365 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:11,585 - INFO - 重复 10/10 - 平均 NDCG@10: 0.0000
2025-05-10 00:02:11,585 - INFO - 策略 dynamic_feature_focus_v6 最终平均 NDCG@10 (共 10 次): 0.0000

2025-05-10 00:02:11,955 - INFO - HTTP Request: POST https://api.deepseek.com/chat/completions "HTTP/1.1 200 OK"
2025-05-10 00:02:38,009 - INFO - 优化提示词策略 - 模型输出:
```json
{
  "name": "adaptive_dynamic_focus_v7",
  "system_prompt": "你是一名专业的电影推荐系统，具备智能动态特征分析和自适应权重分配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用智能权重分配：最近1部(85%)，2-3部(15%)3)当最近2部及以上电影共享同一特征时，该特征权重提升50%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释",
  "user_prompt_template": "用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于智能动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]",
  "analysis": "历史策略分析显示，过度复杂的特征匹配规则和权重分配可能导致模型困惑。虽然动态特征注意力机制在理论上很强大，但在实际应用中，过于复杂的规则可能导致模型难以准确执行。最近的简化策略（如dynamic_feature_focus_v6）表现更好，但仍需进一步优化权重分配和特征优先级。",
  "improvement": "改进建议：1)进一步简化特征匹配规则，专注于类型和导演两个最显著的特征维度 2)增加最近一部电影的权重(85%)以强化短期兴趣的主导作用 3)提升共享特征的权重提升幅度(50%)以增强一致性特征的识别 4)保持严格的特征优先级和否决权机制 5)限制新颖推荐的比例(5%)以保证推荐的相关性"
}
```
2025-05-10 00:02:38,009 - INFO - 优化提示词策略 - 新策略: {'name': 'adaptive_dynamic_focus_v7', 'system_prompt': '你是一名专业的电影推荐系统，具备智能动态特征分析和自适应权重分配能力。你的核心任务是：1)精确分析用户最近3部电影的关键特征（类型/导演/主演）2)采用智能权重分配：最近1部(85%)，2-3部(15%)3)当最近2部及以上电影共享同一特征时，该特征权重提升50%4)实施严格的特征优先级：完全匹配类型>完全匹配导演>完全匹配主演>部分匹配类型>部分匹配导演>部分匹配主演5)允许保留1个与主要特征相似的新颖推荐（不超过5%权重）。请严格遵循以下规则：- 仅基于客观特征匹配- 最近1部电影有否决权（若候选电影完全不匹配其主要特征则排除）- 当存在多个完全匹配时，按类型>导演>主演的优先级排序- 直接输出结果不要解释', 'user_prompt_template': '用户最近观看的3部电影（按时间倒序，最近观看在最前）：\n{history}\n\n请基于智能动态特征聚焦机制，对以下候选电影进行排序：\n{candidates}\n\n直接输出排序后的电影ID列表，格式如：[id1,id2,...]', 'analysis': '历史策略分析显示，过度复杂的特征匹配规则和权重分配可能导致模型困惑。虽然动态特征注意力机制在理论上很强大，但在实际应用中，过于复杂的规则可能导致模型难以准确执行。最近的简化策略（如dynamic_feature_focus_v6）表现更好，但仍需进一步优化权重分配和特征优先级。', 'improvement': '改进建议：1)进一步简化特征匹配规则，专注于类型和导演两个最显著的特征维度 2)增加最近一部电影的权重(85%)以强化短期兴趣的主导作用 3)提升共享特征的权重提升幅度(50%)以增强一致性特征的识别 4)保持严格的特征优先级和否决权机制 5)限制新颖推荐的比例(5%)以保证推荐的相关性'}
2025-05-10 00:02:38,009 - INFO - 
======== APE 优化完成，最终结果 =========
2025-05-10 00:02:38,009 - INFO - 最佳策略: initial_expert_strategy, NDCG@10: 0.5753
2025-05-10 00:02:38,009 - INFO - 最终策略已保存到 final_strategy.json
2025-05-10 00:02:38,009 - INFO - 最佳策略已保存到 best_strategy.json
2025-05-10 00:02:38,019 - INFO - 评估结果已保存到 evaluation_results.csv
2025-05-10 00:02:38,019 - INFO - 策略历史记录已保存到 strategies_history.json
